2025-03-02 15:10:18.856 +02:00 [INF] Application Started!
2025-03-02 15:10:19.708 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-02 15:10:20.372 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-02 15:10:20.409 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-02 15:10:20.698 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-02 15:10:21.552 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-02 15:10:21.943 +02:00 [INF] Hosting environment: Development
2025-03-02 15:10:21.985 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-02 15:10:22.548 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 1000.2426ms
2025-03-02 15:10:22.659 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-02 15:10:22.659 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-02 15:10:22.706 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-02 15:10:22.771 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 111.6591ms
2025-03-02 15:10:22.843 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 184.4063ms
2025-03-02 15:10:22.922 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 215.4321ms
2025-03-02 15:10:23.549 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-02 15:10:23.811 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 261.6616ms
2025-03-02 15:11:59.536 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - multipart/form-data; boundary=----WebKitFormBoundaryIOnb5c61JNZ7xRHt 277
2025-03-02 15:11:59.606 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:11:59.849 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-02 15:11:59.989 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-02 15:12:02.116 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 2107.1984ms
2025-03-02 15:12:02.125 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-02 15:12:02.132 +02:00 [ERR] An unhandled exception has occurred while executing the request.
AutoMapper.AutoMapperMappingException: Missing type map configuration or unsupported mapping.

Mapping types:
AssignEmployeePermissionDto -> PharmacyEmployeePermission
Shared.DataTransferObjects.AssignEmployeePermissionDto -> Entities.Models.PharmacyEmployeePermission
   at lambda_method54(Closure, Object, PharmacyEmployeePermission, ResolutionContext)
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 23
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:12:02.224 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 2687.6168ms
2025-03-02 15:12:50.578 +02:00 [INF] Application Started!
2025-03-02 15:12:51.274 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-02 15:12:51.685 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-02 15:12:52.208 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-02 15:12:52.311 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-02 15:12:52.588 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-02 15:12:52.597 +02:00 [INF] Hosting environment: Development
2025-03-02 15:12:52.600 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-02 15:12:52.899 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 693.9487ms
2025-03-02 15:12:53.053 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-02 15:12:53.088 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-02 15:12:53.092 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-02 15:12:53.363 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 272.0767ms
2025-03-02 15:12:53.378 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 324.4724ms
2025-03-02 15:12:53.516 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 424.2287ms
2025-03-02 15:12:53.830 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-02 15:12:54.032 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 201.7722ms
2025-03-02 15:13:10.750 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - multipart/form-data; boundary=----WebKitFormBoundaryAcdCjUEIYn2APyOj 277
2025-03-02 15:13:10.839 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:13:10.961 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-02 15:13:11.068 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-02 15:13:16.763 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.772 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.777 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.782 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.791 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.796 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.803 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.809 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.814 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.822 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.827 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.831 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.839 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:16.843 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:13:17.106 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-02 15:13:17.111 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-02 15:13:18.403 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.RepositoryContext'.
System.InvalidOperationException: The value of 'PharmacyEmployeePermission.EmployeeID' is unknown when attempting to save changes. This is because the property is also part of a foreign key for which the principal entity in the relationship is not known.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.PrepareToSave()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.GetEntriesToSave(Boolean cascadeChanges)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: The value of 'PharmacyEmployeePermission.EmployeeID' is unknown when attempting to save changes. This is because the property is also part of a foreign key for which the principal entity in the relationship is not known.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.PrepareToSave()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.GetEntriesToSave(Boolean cascadeChanges)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-02 15:13:18.439 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 7329.5629ms
2025-03-02 15:13:18.445 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-02 15:13:18.452 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The value of 'PharmacyEmployeePermission.EmployeeID' is unknown when attempting to save changes. This is because the property is also part of a foreign key for which the principal entity in the relationship is not known.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.PrepareToSave()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.GetEntriesToSave(Boolean cascadeChanges)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Repository.RepositoryManager.SaveAsync() in E:\GP\Back\Pill-Spot\Repository\RepositoryManager.cs:line 63
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 25
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:13:18.541 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 7791.9317ms
2025-03-02 15:14:21.980 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - multipart/form-data; boundary=----WebKitFormBoundaryA8vaenjwWW7TN64C 274
2025-03-02 15:14:22.012 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:14:22.029 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-02 15:14:22.062 +02:00 [INF] Route matched with {action = "AssignPermissionToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToAdmin(Shared.DataTransferObjects.AssignAdminPermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-02 15:14:23.820 +02:00 [INF] Executed DbCommand (354ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `AdminPermissions` (`AdminID`, `PermissionID`)
VALUES (@p0, @p1);
2025-03-02 15:14:23.956 +02:00 [INF] Executing CreatedAtRouteResult, writing value of type 'Shared.DataTransferObjects.AdminPermissionDto'.
2025-03-02 15:14:24.017 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation) in 1934.7367ms
2025-03-02 15:14:24.026 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-02 15:14:24.047 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - 201 null application/json; charset=utf-8 2066.9866ms
2025-03-02 15:24:11.066 +02:00 [INF] Application Started!
2025-03-02 15:24:11.739 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-02 15:24:12.637 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-02 15:24:12.646 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-02 15:24:12.980 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-02 15:24:13.016 +02:00 [INF] Hosting environment: Development
2025-03-02 15:24:13.017 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-02 15:24:13.024 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-02 15:24:13.346 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The constraint reference 'string' could not be resolved to a type. Register the constraint type with 'Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap'.
   at Microsoft.AspNetCore.Routing.DefaultParameterPolicyFactory.Create(RoutePatternParameterPart parameter, String inlineText)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherBuilder.CachingParameterPolicyFactory.Create(RoutePatternParameterPart parameter, String inlineText)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherBuilder.DfaBuilderWorker.AddParentsWithMatchingLiteralConstraints(List`1 nextParents, DfaNode parent, RoutePatternParameterPart parameterPart, IReadOnlyList`1 parameterPolicyReferences)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherBuilder.DfaBuilderWorker.ProcessSegment(RouteEndpoint endpoint, List`1 parents, List`1 nextParents, RoutePatternPathSegment segment)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherBuilder.DfaBuilderWorker.ProcessLevel(Int32 depth)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherBuilder.BuildDfaTree(Boolean includeLabel)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherBuilder.Build()
   at Microsoft.AspNetCore.Routing.Matching.DataSourceDependentMatcher.CreateMatcher(IReadOnlyList`1 endpoints)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T& target, Boolean& initialized, Object& syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.Matching.DataSourceDependentMatcher..ctor(EndpointDataSource dataSource, Lifetime lifetime, Func`1 matcherBuilderFactory)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherFactory.CreateMatcher(EndpointDataSource dataSource)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.InitializeCoreAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.<Invoke>g__AwaitMatcher|10_0(EndpointRoutingMiddleware middleware, HttpContext httpContext, Task`1 matcherTask)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:24:13.548 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 500 null text/html; charset=utf-8 533.1581ms
2025-03-02 15:24:13.695 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-02 15:24:13.695 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-02 15:24:13.739 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 43.796ms
2025-03-02 15:24:13.966 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 270.7712ms
2025-03-02 15:24:14.065 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/favicon.ico - null null
2025-03-02 15:24:14.226 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The constraint reference 'string' could not be resolved to a type. Register the constraint type with 'Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap'.
   at Microsoft.AspNetCore.Routing.DefaultParameterPolicyFactory.Create(RoutePatternParameterPart parameter, String inlineText)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherBuilder.CachingParameterPolicyFactory.Create(RoutePatternParameterPart parameter, String inlineText)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherBuilder.DfaBuilderWorker.AddParentsWithMatchingLiteralConstraints(List`1 nextParents, DfaNode parent, RoutePatternParameterPart parameterPart, IReadOnlyList`1 parameterPolicyReferences)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherBuilder.DfaBuilderWorker.ProcessSegment(RouteEndpoint endpoint, List`1 parents, List`1 nextParents, RoutePatternPathSegment segment)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherBuilder.DfaBuilderWorker.ProcessLevel(Int32 depth)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherBuilder.BuildDfaTree(Boolean includeLabel)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherBuilder.Build()
   at Microsoft.AspNetCore.Routing.Matching.DataSourceDependentMatcher.CreateMatcher(IReadOnlyList`1 endpoints)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T& target, Boolean& initialized, Object& syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.Matching.DataSourceDependentMatcher..ctor(EndpointDataSource dataSource, Lifetime lifetime, Func`1 matcherBuilderFactory)
   at Microsoft.AspNetCore.Routing.Matching.DfaMatcherFactory.CreateMatcher(EndpointDataSource dataSource)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.InitializeCoreAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.<Invoke>g__AwaitMatcher|10_0(EndpointRoutingMiddleware middleware, HttpContext httpContext, Task`1 matcherTask)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:24:14.291 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/favicon.ico - 500 null text/plain; charset=utf-8 226.0779ms
2025-03-02 15:25:13.192 +02:00 [INF] Application Started!
2025-03-02 15:25:13.862 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-02 15:25:14.475 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-02 15:25:14.512 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-02 15:25:14.775 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-02 15:25:15.287 +02:00 [INF] Hosting environment: Development
2025-03-02 15:25:15.284 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-02 15:25:15.289 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-02 15:25:15.996 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 714.9429ms
2025-03-02 15:25:16.145 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-02 15:25:16.147 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-02 15:25:16.151 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-02 15:25:16.217 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 69.5854ms
2025-03-02 15:25:16.230 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 84.3533ms
2025-03-02 15:25:16.433 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 282.0083ms
2025-03-02 15:25:16.751 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-02 15:25:17.132 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 381.3402ms
2025-03-02 15:25:35.677 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 77
2025-03-02 15:25:35.781 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:25:35.950 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-02 15:25:36.046 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-02 15:25:41.033 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.042 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.046 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.051 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.059 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.064 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.072 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.077 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.082 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.090 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.094 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.101 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.108 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.113 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:25:41.363 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-02 15:25:41.372 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-02 15:25:42.308 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 6230.245ms
2025-03-02 15:25:42.313 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-02 15:25:42.323 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.GetOrCreateEntry(Object entity, IEntityType entityType)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.EntryWithoutDetectChanges(TEntity entity)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at Repository.RepositoryBase`1.Create(T entity) in E:\GP\Back\Pill-Spot\Repository\RepositoryBase.cs:line 17
   at Repository.EmployeePermissionRepository.AssignPermissionToEmployeeAsync(PharmacyEmployeePermission employeePermission) in E:\GP\Back\Pill-Spot\Repository\EmployeePermissionRepository.cs:line 13
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 24
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:25:42.437 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 6760.3379ms
2025-03-02 15:30:03.385 +02:00 [INF] Application Started!
2025-03-02 15:30:04.592 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-02 15:30:05.401 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-02 15:30:05.415 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-02 15:30:05.647 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-02 15:30:05.652 +02:00 [INF] Hosting environment: Development
2025-03-02 15:30:05.662 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-02 15:30:06.091 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-02 15:30:06.657 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 570.459ms
2025-03-02 15:30:06.791 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-02 15:30:06.791 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-02 15:30:06.824 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-02 15:30:06.866 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 74.371ms
2025-03-02 15:30:06.900 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 109.5165ms
2025-03-02 15:30:07.033 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 208.5252ms
2025-03-02 15:30:07.194 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-02 15:30:07.422 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 227.7922ms
2025-03-02 15:30:25.315 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 77
2025-03-02 15:30:25.414 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:30:25.546 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-02 15:30:25.677 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-02 15:30:30.688 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.694 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.702 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.707 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.724 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.735 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.779 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.791 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.803 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.808 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.812 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.819 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.824 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:30.828 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:30:31.083 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-02 15:30:31.089 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-02 15:30:32.112 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 6409.9575ms
2025-03-02 15:30:32.119 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-02 15:30:32.124 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.GetOrCreateEntry(Object entity, IEntityType entityType)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.EntryWithoutDetectChanges(TEntity entity)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at Repository.RepositoryBase`1.Create(T entity) in E:\GP\Back\Pill-Spot\Repository\RepositoryBase.cs:line 17
   at Repository.EmployeePermissionRepository.AssignPermissionToEmployeeAsync(PharmacyEmployeePermission employeePermission) in E:\GP\Back\Pill-Spot\Repository\EmployeePermissionRepository.cs:line 13
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 24
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:30:32.231 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 6916.6333ms
2025-03-02 15:31:03.237 +02:00 [INF] Application Started!
2025-03-02 15:31:04.007 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-02 15:31:04.502 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-02 15:31:04.530 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-02 15:31:04.852 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-02 15:31:04.874 +02:00 [INF] Hosting environment: Development
2025-03-02 15:31:04.876 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-02 15:31:05.005 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-02 15:31:05.687 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 689.2727ms
2025-03-02 15:31:05.844 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-02 15:31:05.844 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-02 15:31:05.845 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-02 15:31:05.874 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 29.463ms
2025-03-02 15:31:05.892 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 47.9946ms
2025-03-02 15:31:06.001 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 155.5664ms
2025-03-02 15:31:06.637 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-02 15:31:06.831 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 194.6258ms
2025-03-02 15:31:49.308 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 77
2025-03-02 15:31:49.417 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:31:49.530 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-02 15:31:49.653 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-02 15:31:54.928 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:54.933 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:54.941 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:54.946 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:54.954 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:54.959 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:54.963 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:54.971 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:54.975 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:54.980 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:54.987 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:54.992 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:54.997 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:55.004 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 15:31:55.259 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-02 15:31:55.265 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-02 15:31:56.174 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 6495.0945ms
2025-03-02 15:31:56.182 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-02 15:31:56.191 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.GetOrCreateEntry(Object entity, IEntityType entityType)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.EntryWithoutDetectChanges(TEntity entity)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at Repository.RepositoryBase`1.Create(T entity) in E:\GP\Back\Pill-Spot\Repository\RepositoryBase.cs:line 17
   at Repository.EmployeePermissionRepository.AssignPermissionToEmployeeAsync(PharmacyEmployeePermission employeePermission) in E:\GP\Back\Pill-Spot\Repository\EmployeePermissionRepository.cs:line 13
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 24
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:31:56.310 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 7002.0121ms
2025-03-02 15:32:24.819 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - application/json-patch+json 43
2025-03-02 15:32:24.913 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:32:24.992 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-02 15:32:25.044 +02:00 [INF] Route matched with {action = "AssignPermissionToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToAdmin(Shared.DataTransferObjects.AssignAdminPermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-02 15:32:26.353 +02:00 [ERR] Failed executing DbCommand (164ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `AdminPermissions` (`AdminID`, `PermissionID`)
VALUES (@p0, @p1);
2025-03-02 15:32:26.452 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.RepositoryContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`adminpermissions`, CONSTRAINT `FK_AdminPermissions_AspNetUsers_AdminID` FOREIGN KEY (`AdminID`) REFERENCES `aspnetusers` (`Id`) ON DELETE CASCADE)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`adminpermissions`, CONSTRAINT `FK_AdminPermissions_AspNetUsers_AdminID` FOREIGN KEY (`AdminID`) REFERENCES `aspnetusers` (`Id`) ON DELETE CASCADE)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-02 15:32:26.528 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation) in 1474.7807ms
2025-03-02 15:32:26.533 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-02 15:32:26.543 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`adminpermissions`, CONSTRAINT `FK_AdminPermissions_AspNetUsers_AdminID` FOREIGN KEY (`AdminID`) REFERENCES `aspnetusers` (`Id`) ON DELETE CASCADE)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Repository.RepositoryManager.SaveAsync() in E:\GP\Back\Pill-Spot\Repository\RepositoryManager.cs:line 63
   at Service.AdminPermissionService.AssignPermissionToAdminAsync(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 30
   at PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 105
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:32:26.652 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - 500 null text/plain; charset=utf-8 1832.3323ms
2025-03-02 15:33:00.311 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - application/json-patch+json 76
2025-03-02 15:33:00.436 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:33:00.452 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-02 15:33:00.465 +02:00 [INF] Route matched with {action = "AssignPermissionToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToAdmin(Shared.DataTransferObjects.AssignAdminPermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-02 15:33:00.733 +02:00 [ERR] Failed executing DbCommand (22ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `AdminPermissions` (`AdminID`, `PermissionID`)
VALUES (@p0, @p1);
2025-03-02 15:33:00.753 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.RepositoryContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry 'acef94d0-afc4-42e5-a1ad-29b3f3aa67b7-1' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry 'acef94d0-afc4-42e5-a1ad-29b3f3aa67b7-1' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-02 15:33:00.854 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation) in 373.371ms
2025-03-02 15:33:00.868 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-02 15:33:00.893 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry 'acef94d0-afc4-42e5-a1ad-29b3f3aa67b7-1' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Repository.RepositoryManager.SaveAsync() in E:\GP\Back\Pill-Spot\Repository\RepositoryManager.cs:line 63
   at Service.AdminPermissionService.AssignPermissionToAdminAsync(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 30
   at PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 105
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:33:01.086 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - 500 null text/plain; charset=utf-8 775.5167ms
2025-03-02 15:33:11.580 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - application/json-patch+json 76
2025-03-02 15:33:11.610 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:33:11.767 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-02 15:33:11.786 +02:00 [INF] Route matched with {action = "AssignPermissionToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToAdmin(Shared.DataTransferObjects.AssignAdminPermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-02 15:33:11.924 +02:00 [ERR] Failed executing DbCommand (9ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `AdminPermissions` (`AdminID`, `PermissionID`)
VALUES (@p0, @p1);
2025-03-02 15:33:11.956 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.RepositoryContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry 'acef94d0-afc4-42e5-a1ad-29b3f3aa67b7-2' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry 'acef94d0-afc4-42e5-a1ad-29b3f3aa67b7-2' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-02 15:33:12.081 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation) in 275.5607ms
2025-03-02 15:33:12.090 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-02 15:33:12.096 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry 'acef94d0-afc4-42e5-a1ad-29b3f3aa67b7-2' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Repository.RepositoryManager.SaveAsync() in E:\GP\Back\Pill-Spot\Repository\RepositoryManager.cs:line 63
   at Service.AdminPermissionService.AssignPermissionToAdminAsync(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 30
   at PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 105
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:33:12.287 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - 500 null text/plain; charset=utf-8 706.3801ms
2025-03-02 15:33:40.163 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - application/json-patch+json 76
2025-03-02 15:33:40.312 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:33:40.317 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-02 15:33:40.342 +02:00 [INF] Route matched with {action = "AssignPermissionToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToAdmin(Shared.DataTransferObjects.AssignAdminPermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-02 15:33:40.475 +02:00 [ERR] Failed executing DbCommand (9ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `AdminPermissions` (`AdminID`, `PermissionID`)
VALUES (@p0, @p1);
2025-03-02 15:33:40.498 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.RepositoryContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`adminpermissions`, CONSTRAINT `FK_AdminPermissions_Permissions_PermissionID` FOREIGN KEY (`PermissionID`) REFERENCES `permissions` (`PermissionID`) ON DELETE CASCADE)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`adminpermissions`, CONSTRAINT `FK_AdminPermissions_Permissions_PermissionID` FOREIGN KEY (`PermissionID`) REFERENCES `permissions` (`PermissionID`) ON DELETE CASCADE)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-02 15:33:40.626 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation) in 265.6037ms
2025-03-02 15:33:40.632 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-02 15:33:40.642 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`adminpermissions`, CONSTRAINT `FK_AdminPermissions_Permissions_PermissionID` FOREIGN KEY (`PermissionID`) REFERENCES `permissions` (`PermissionID`) ON DELETE CASCADE)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Repository.RepositoryManager.SaveAsync() in E:\GP\Back\Pill-Spot\Repository\RepositoryManager.cs:line 63
   at Service.AdminPermissionService.AssignPermissionToAdminAsync(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 30
   at PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 105
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:33:40.845 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - 500 null text/plain; charset=utf-8 681.6731ms
2025-03-02 15:47:53.045 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign-multiple/acef94d0-afc4-42e5-a1ad-29b3f3aa67b79 - application/json-patch+json 11
2025-03-02 15:47:53.061 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:47:53.065 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin (PillSpot.Presentation)'
2025-03-02 15:47:53.098 +02:00 [INF] Route matched with {action = "AssignPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionsToAdmin(System.String, System.Collections.Generic.IEnumerable`1[System.Int32]) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-02 15:47:53.381 +02:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (Size = 255), @p3='?' (DbType = Int32), @p4='?' (Size = 255), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `AdminPermissions` (`AdminID`, `PermissionID`)
VALUES (@p0, @p1),
(@p2, @p3),
(@p4, @p5);
2025-03-02 15:47:53.414 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.RepositoryContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`adminpermissions`, CONSTRAINT `FK_AdminPermissions_AspNetUsers_AdminID` FOREIGN KEY (`AdminID`) REFERENCES `aspnetusers` (`Id`) ON DELETE CASCADE)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`adminpermissions`, CONSTRAINT `FK_AdminPermissions_AspNetUsers_AdminID` FOREIGN KEY (`AdminID`) REFERENCES `aspnetusers` (`Id`) ON DELETE CASCADE)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-02 15:47:53.536 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin (PillSpot.Presentation) in 428.909ms
2025-03-02 15:47:53.548 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin (PillSpot.Presentation)'
2025-03-02 15:47:53.559 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`adminpermissions`, CONSTRAINT `FK_AdminPermissions_AspNetUsers_AdminID` FOREIGN KEY (`AdminID`) REFERENCES `aspnetusers` (`Id`) ON DELETE CASCADE)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Repository.RepositoryManager.SaveAsync() in E:\GP\Back\Pill-Spot\Repository\RepositoryManager.cs:line 63
   at Service.AdminPermissionService.AssignPermissionsToAdminAsync(String adminId, IEnumerable`1 permissionIds) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 43
   at PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin(String adminId, IEnumerable`1 permissionIds) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 112
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:47:53.712 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign-multiple/acef94d0-afc4-42e5-a1ad-29b3f3aa67b79 - 500 null text/plain; charset=utf-8 666.6351ms
2025-03-02 15:48:14.686 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/acef94d0-afc4-42e5-a1ad-29b3f3aa67b7 - null null
2025-03-02 15:48:14.694 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-02 15:48:14.833 +02:00 [INF] Route matched with {action = "GetPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPermissionsToAdmin(System.String) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-02 15:48:16.369 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminID`, `a`.`PermissionID`, `p`.`PermissionID`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionID` = `p`.`PermissionID`
WHERE `a`.`AdminID` = @__adminId_0
2025-03-02 15:48:16.488 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[Entities.Models.AdminPermission, Entities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Shared.DataTransferObjects.PermissionDto, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-02 15:48:16.519 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation) in 1594.2149ms
2025-03-02 15:48:16.533 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-02 15:48:16.544 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/acef94d0-afc4-42e5-a1ad-29b3f3aa67b7 - 200 null application/json; charset=utf-8 1857.7204ms
2025-03-02 15:48:19.833 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/acef94d0-afc4-42e5-a1ad-29b3f3aa67b71 - null null
2025-03-02 15:48:19.841 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-02 15:48:19.846 +02:00 [INF] Route matched with {action = "GetPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPermissionsToAdmin(System.String) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-02 15:48:20.035 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminID`, `a`.`PermissionID`, `p`.`PermissionID`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionID` = `p`.`PermissionID`
WHERE `a`.`AdminID` = @__adminId_0
2025-03-02 15:48:20.057 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation) in 121.9707ms
2025-03-02 15:48:20.067 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-02 15:48:20.072 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.AdminPermissionNotFoundException: No permissions found for Admin with ID: acef94d0-afc4-42e5-a1ad-29b3f3aa67b71.
   at Service.AdminPermissionService.GetPermissionsToAdminAsync(String adminId, Boolean trackChanges) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 52
   at PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin(String adminId) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 119
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:48:20.152 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/acef94d0-afc4-42e5-a1ad-29b3f3aa67b71 - 500 null text/plain; charset=utf-8 318.5318ms
2025-03-02 15:48:44.810 +02:00 [INF] Request starting HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove/acef94d0-afc4-42e5-a1ad-29b3f3aa67b71/2 - null null
2025-03-02 15:48:44.823 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:48:44.832 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin (PillSpot.Presentation)'
2025-03-02 15:48:44.861 +02:00 [INF] Route matched with {action = "RemovePermissionFromAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RemovePermissionFromAdmin(System.String, Int32) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-02 15:48:44.961 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminID`, `a`.`PermissionID`, `p`.`PermissionID`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionID` = `p`.`PermissionID`
WHERE `a`.`AdminID` = @__adminId_0
2025-03-02 15:48:44.981 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin (PillSpot.Presentation) in 113.8596ms
2025-03-02 15:48:44.992 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin (PillSpot.Presentation)'
2025-03-02 15:48:44.996 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.AdminPermissionNotFoundException: Permission with ID: 2 not found for Admin with ID: acef94d0-afc4-42e5-a1ad-29b3f3aa67b71.
   at Service.AdminPermissionService.RemovePermissionFromAdminAsync(String adminId, Int32 permissionId) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 65
   at PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin(String adminId, Int32 permissionId) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 126
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:48:45.043 +02:00 [INF] Request finished HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove/acef94d0-afc4-42e5-a1ad-29b3f3aa67b71/2 - 500 null text/plain; charset=utf-8 232.9434ms
2025-03-02 15:49:01.796 +02:00 [INF] Request starting HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove/acef94d0-afc4-42e5-a1ad-29b3f3aa67b7/2 - null null
2025-03-02 15:49:01.982 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:49:01.984 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin (PillSpot.Presentation)'
2025-03-02 15:49:01.997 +02:00 [INF] Route matched with {action = "RemovePermissionFromAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RemovePermissionFromAdmin(System.String, Int32) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-02 15:49:02.107 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminID`, `a`.`PermissionID`, `p`.`PermissionID`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionID` = `p`.`PermissionID`
WHERE `a`.`AdminID` = @__adminId_0
2025-03-02 15:49:02.281 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
DELETE FROM `AdminPermissions`
WHERE `AdminID` = @p0 AND `PermissionID` = @p1;
SELECT ROW_COUNT();
2025-03-02 15:49:02.342 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-03-02 15:49:02.348 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin (PillSpot.Presentation) in 335.1273ms
2025-03-02 15:49:02.359 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin (PillSpot.Presentation)'
2025-03-02 15:49:02.364 +02:00 [INF] Request finished HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove/acef94d0-afc4-42e5-a1ad-29b3f3aa67b7/2 - 204 null null 568.3467ms
2025-03-02 15:49:15.213 +02:00 [INF] Request starting HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove-multiple/1 - application/json-patch+json 7
2025-03-02 15:49:15.233 +02:00 [INF] CORS policy execution successful.
2025-03-02 15:49:15.287 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation)'
2025-03-02 15:49:15.314 +02:00 [INF] Route matched with {action = "RemovePermissionsFromAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RemovePermissionsFromAdmin(System.String, System.Collections.Generic.IEnumerable`1[System.Int32]) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-02 15:49:15.414 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminID`, `a`.`PermissionID`, `p`.`PermissionID`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionID` = `p`.`PermissionID`
WHERE `a`.`AdminID` = @__adminId_0
2025-03-02 15:49:15.446 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation) in 123.6326ms
2025-03-02 15:49:15.459 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation)'
2025-03-02 15:49:15.475 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.AdminPermissionNotFoundException: No permissions found for Admin with ID: 1.
   at Service.AdminPermissionService.RemovePermissionsFromAdminAsync(String adminId, IEnumerable`1 permissionIds) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 81
   at PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin(String adminId, IEnumerable`1 permissionIds) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 133
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 15:49:15.589 +02:00 [INF] Request finished HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove-multiple/1 - 500 null text/plain; charset=utf-8 376.3167ms
2025-03-02 16:17:31.815 +02:00 [INF] Application Started!
2025-03-02 16:17:32.369 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-02 16:17:32.770 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-02 16:17:32.775 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-02 16:17:33.074 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-02 16:17:33.859 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-02 16:17:34.271 +02:00 [INF] Hosting environment: Development
2025-03-02 16:17:34.323 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-02 16:17:34.859 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 995.9514ms
2025-03-02 16:17:35.068 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-02 16:17:35.069 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-02 16:17:35.078 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-02 16:17:35.346 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 278.0626ms
2025-03-02 16:17:35.399 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 329.6841ms
2025-03-02 16:17:35.485 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 407.428ms
2025-03-02 16:17:35.712 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-02 16:17:35.974 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 262.1004ms
2025-03-02 16:18:57.273 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-02 16:18:57.578 +02:00 [INF] CORS policy execution successful.
2025-03-02 16:18:58.011 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-02 16:18:58.148 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-02 16:19:04.812 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:04.823 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:04.835 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:04.847 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:04.855 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:04.866 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:04.874 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:04.911 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:04.923 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:05.000 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:05.089 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:05.235 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:05.370 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:05.513 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-02 16:19:05.856 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-02 16:19:05.869 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-02 16:19:07.862 +02:00 [ERR] Failed executing DbCommand (195ms) [Parameters=[@p0='?' (DbType = UInt64), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `PharmacyEmployeePermissions` (`EmployeeId`, `PermissionId`)
VALUES (@p0, @p1);
2025-03-02 16:19:07.971 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.RepositoryContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`pharmacyemployeepermissions`, CONSTRAINT `FK_PharmacyEmployeePermissions_PharmacyEmployees_EmployeeId` FOREIGN KEY (`EmployeeId`) REFERENCES `pharmacyemployees` (`EmployeeID`) ON D)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`pharmacyemployeepermissions`, CONSTRAINT `FK_PharmacyEmployeePermissions_PharmacyEmployees_EmployeeId` FOREIGN KEY (`EmployeeId`) REFERENCES `pharmacyemployees` (`EmployeeID`) ON D)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-02 16:19:08.083 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 9160.9862ms
2025-03-02 16:19:08.101 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-02 16:19:08.118 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`pharmacyemployeepermissions`, CONSTRAINT `FK_PharmacyEmployeePermissions_PharmacyEmployees_EmployeeId` FOREIGN KEY (`EmployeeId`) REFERENCES `pharmacyemployees` (`EmployeeID`) ON D)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Repository.RepositoryManager.SaveAsync() in E:\GP\Back\Pill-Spot\Repository\RepositoryManager.cs:line 63
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 25
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-02 16:19:08.288 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 11015.2517ms
