2025-03-03 14:40:58.175 +02:00 [INF] Application Started!
2025-03-03 14:40:59.009 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 14:40:59.878 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 14:40:59.926 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 14:41:00.257 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 14:41:00.389 +02:00 [INF] Hosting environment: Development
2025-03-03 14:41:01.130 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 14:41:05.448 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 14:41:06.313 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 864.2271ms
2025-03-03 14:41:06.571 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 14:41:06.579 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 14:41:06.582 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 14:41:06.660 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 81.4349ms
2025-03-03 14:41:06.748 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 189.9198ms
2025-03-03 14:41:06.916 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 334.1692ms
2025-03-03 14:41:07.182 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 14:41:07.719 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 537.2697ms
2025-03-03 14:53:35.366 +02:00 [INF] Application Started!
2025-03-03 14:53:36.013 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 14:53:36.587 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 14:53:37.281 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 14:53:37.346 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 14:53:37.612 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 14:53:37.617 +02:00 [INF] Hosting environment: Development
2025-03-03 14:53:37.619 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 14:53:38.088 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 750.765ms
2025-03-03 14:53:38.284 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 14:53:38.311 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 14:53:38.327 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 14:53:38.397 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 86.2498ms
2025-03-03 14:53:38.448 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 164.4627ms
2025-03-03 14:53:38.629 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 302.1428ms
2025-03-03 14:53:38.882 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 14:53:39.149 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 266.4423ms
2025-03-03 14:55:12.007 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/authentication - multipart/form-data; boundary=----WebKitFormBoundarydkrPGjKXvbMco40r 976
2025-03-03 14:55:12.093 +02:00 [INF] CORS policy execution successful.
2025-03-03 14:55:12.237 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation)'
2025-03-03 14:55:12.340 +02:00 [INF] Route matched with {action = "RegisterUser", controller = "Authentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterUser(Shared.DataTransferObjects.UserForRegistrationDto) on controller PillSpot.Presentation.Controllers.AuthenticationController (PillSpot.Presentation).
2025-03-03 14:55:18.413 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.423 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.432 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.439 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.447 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.455 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.462 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.470 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.477 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.486 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.494 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.503 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.513 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.519 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 14:55:18.799 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 14:55:18.806 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 14:55:21.167 +02:00 [INF] Executed DbCommand (154ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 14:55:21.326 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 14:55:22.435 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (Size = 100), @p8='?' (DbType = Int32), @p9='?' (Size = 100), @p10='?' (DbType = Guid), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 256), @p14='?' (Size = 256), @p15='?' (Size = 4000), @p16='?' (Size = 4000), @p17='?' (DbType = Boolean), @p18='?' (Size = 500), @p19='?' (Size = 4000), @p20='?' (DbType = DateTime), @p21='?' (Size = 4000), @p22='?' (DbType = Boolean), @p23='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUsers` (`Id`, `AccessFailedCount`, `ConcurrencyStamp`, `CreatedDate`, `DateOfBirth`, `Email`, `EmailConfirmed`, `FirstName`, `Gender`, `LastName`, `LocationID`, `LockoutEnabled`, `LockoutEnd`, `NormalizedEmail`, `NormalizedUserName`, `PasswordHash`, `PhoneNumber`, `PhoneNumberConfirmed`, `ProfilePictureUrl`, `RefreshToken`, `RefreshTokenExpiryTime`, `SecurityStamp`, `TwoFactorEnabled`, `UserName`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23);
SELECT `IsDeleted`, `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p0;
2025-03-03 14:55:22.668 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 14:55:22.829 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 14:55:22.860 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 14:55:22.919 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 14:55:22.945 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 14:55:23.070 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (Size = 255), @p26='?' (Size = 255), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p27='?' (Size = 4000), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (DbType = Boolean), @p11='?' (Size = 100), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = DateTimeOffset), @p15='?' (Size = 256), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (Size = 500), @p21='?' (Size = 4000), @p22='?' (DbType = DateTime), @p28='?' (DbType = DateTime), @p23='?' (Size = 4000), @p24='?' (DbType = Boolean), @p25='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserRoles` (`RoleId`, `UserId`)
VALUES (@p0, @p1);
UPDATE `AspNetUsers` SET `AccessFailedCount` = @p2, `ConcurrencyStamp` = @p3, `CreatedDate` = @p4, `DateOfBirth` = @p5, `Email` = @p6, `EmailConfirmed` = @p7, `FirstName` = @p8, `Gender` = @p9, `IsDeleted` = @p10, `LastName` = @p11, `LocationID` = @p12, `LockoutEnabled` = @p13, `LockoutEnd` = @p14, `NormalizedEmail` = @p15, `NormalizedUserName` = @p16, `PasswordHash` = @p17, `PhoneNumber` = @p18, `PhoneNumberConfirmed` = @p19, `ProfilePictureUrl` = @p20, `RefreshToken` = @p21, `RefreshTokenExpiryTime` = @p22, `SecurityStamp` = @p23, `TwoFactorEnabled` = @p24, `UserName` = @p25
WHERE `Id` = @p26 AND `ConcurrencyStamp` = @p27 AND `RowVersion` = @p28;
SELECT `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p26;
2025-03-03 14:55:23.115 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 201
2025-03-03 14:55:23.130 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation) in 10766.6453ms
2025-03-03 14:55:23.138 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation)'
2025-03-03 14:55:23.188 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/authentication - 201 0 null 11181.0871ms
2025-03-03 14:55:36.683 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/authentication - multipart/form-data; boundary=----WebKitFormBoundary5skQorMvSVBGY5nG 977
2025-03-03 14:55:36.705 +02:00 [INF] CORS policy execution successful.
2025-03-03 14:55:36.716 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation)'
2025-03-03 14:55:36.723 +02:00 [INF] Route matched with {action = "RegisterUser", controller = "Authentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterUser(Shared.DataTransferObjects.UserForRegistrationDto) on controller PillSpot.Presentation.Controllers.AuthenticationController (PillSpot.Presentation).
2025-03-03 14:55:37.311 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 14:55:37.337 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 14:55:37.372 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.SerializableError'.
2025-03-03 14:55:37.402 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation) in 664.0281ms
2025-03-03 14:55:37.412 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation)'
2025-03-03 14:55:37.420 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/authentication - 400 null application/json; charset=utf-8 740.3477ms
2025-03-03 14:55:52.647 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/authentication - multipart/form-data; boundary=----WebKitFormBoundaryN5IJH7TF15K1ZJ5Q 978
2025-03-03 14:55:52.683 +02:00 [INF] CORS policy execution successful.
2025-03-03 14:55:52.695 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation)'
2025-03-03 14:55:52.703 +02:00 [INF] Route matched with {action = "RegisterUser", controller = "Authentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterUser(Shared.DataTransferObjects.UserForRegistrationDto) on controller PillSpot.Presentation.Controllers.AuthenticationController (PillSpot.Presentation).
2025-03-03 14:55:53.084 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 14:55:53.102 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 14:55:53.131 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (Size = 100), @p8='?' (DbType = Int32), @p9='?' (Size = 100), @p10='?' (DbType = Guid), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 256), @p14='?' (Size = 256), @p15='?' (Size = 4000), @p16='?' (Size = 4000), @p17='?' (DbType = Boolean), @p18='?' (Size = 500), @p19='?' (Size = 4000), @p20='?' (DbType = DateTime), @p21='?' (Size = 4000), @p22='?' (DbType = Boolean), @p23='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUsers` (`Id`, `AccessFailedCount`, `ConcurrencyStamp`, `CreatedDate`, `DateOfBirth`, `Email`, `EmailConfirmed`, `FirstName`, `Gender`, `LastName`, `LocationID`, `LockoutEnabled`, `LockoutEnd`, `NormalizedEmail`, `NormalizedUserName`, `PasswordHash`, `PhoneNumber`, `PhoneNumberConfirmed`, `ProfilePictureUrl`, `RefreshToken`, `RefreshTokenExpiryTime`, `SecurityStamp`, `TwoFactorEnabled`, `UserName`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23);
SELECT `IsDeleted`, `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p0;
2025-03-03 14:55:53.156 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 14:55:53.178 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 14:55:53.196 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 14:55:53.215 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 14:55:53.240 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 14:55:53.271 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (Size = 255), @p26='?' (Size = 255), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p27='?' (Size = 4000), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (DbType = Boolean), @p11='?' (Size = 100), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = DateTimeOffset), @p15='?' (Size = 256), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (Size = 500), @p21='?' (Size = 4000), @p22='?' (DbType = DateTime), @p28='?' (DbType = DateTime), @p23='?' (Size = 4000), @p24='?' (DbType = Boolean), @p25='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserRoles` (`RoleId`, `UserId`)
VALUES (@p0, @p1);
UPDATE `AspNetUsers` SET `AccessFailedCount` = @p2, `ConcurrencyStamp` = @p3, `CreatedDate` = @p4, `DateOfBirth` = @p5, `Email` = @p6, `EmailConfirmed` = @p7, `FirstName` = @p8, `Gender` = @p9, `IsDeleted` = @p10, `LastName` = @p11, `LocationID` = @p12, `LockoutEnabled` = @p13, `LockoutEnd` = @p14, `NormalizedEmail` = @p15, `NormalizedUserName` = @p16, `PasswordHash` = @p17, `PhoneNumber` = @p18, `PhoneNumberConfirmed` = @p19, `ProfilePictureUrl` = @p20, `RefreshToken` = @p21, `RefreshTokenExpiryTime` = @p22, `SecurityStamp` = @p23, `TwoFactorEnabled` = @p24, `UserName` = @p25
WHERE `Id` = @p26 AND `ConcurrencyStamp` = @p27 AND `RowVersion` = @p28;
SELECT `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p26;
2025-03-03 14:55:53.298 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 201
2025-03-03 14:55:53.304 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation) in 589.9155ms
2025-03-03 14:55:53.312 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation)'
2025-03-03 14:55:53.320 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/authentication - 201 0 null 673.5983ms
2025-03-03 14:56:34.219 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/Admin/assign-user-role - application/json-patch+json 73
2025-03-03 14:56:34.228 +02:00 [INF] CORS policy execution successful.
2025-03-03 14:56:34.295 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.AdminController.AssignUserRole (PillSpot.Presentation)'
2025-03-03 14:56:34.334 +02:00 [INF] Route matched with {action = "AssignUserRole", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignUserRole(Shared.DataTransferObjects.AssignUserRoleDto) on controller PillSpot.Presentation.Controllers.AdminController (PillSpot.Presentation).
2025-03-03 14:56:34.483 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 14:56:34.662 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a0`.`Name`
FROM `AspNetUserRoles` AS `a`
INNER JOIN `AspNetRoles` AS `a0` ON `a`.`RoleId` = `a0`.`Id`
WHERE `a`.`UserId` = @__userId_0
2025-03-03 14:56:34.684 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 14:56:34.699 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 14:56:34.727 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 14:56:34.755 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 14:56:34.783 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 14:56:34.845 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (Size = 255), @p26='?' (Size = 255), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p27='?' (Size = 4000), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (DbType = Boolean), @p11='?' (Size = 100), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = DateTimeOffset), @p15='?' (Size = 256), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (Size = 500), @p21='?' (Size = 4000), @p22='?' (DbType = DateTime), @p28='?' (DbType = DateTime), @p23='?' (Size = 4000), @p24='?' (DbType = Boolean), @p25='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `AspNetUserRoles`
WHERE `RoleId` = @p0 AND `UserId` = @p1;
SELECT ROW_COUNT();

UPDATE `AspNetUsers` SET `AccessFailedCount` = @p2, `ConcurrencyStamp` = @p3, `CreatedDate` = @p4, `DateOfBirth` = @p5, `Email` = @p6, `EmailConfirmed` = @p7, `FirstName` = @p8, `Gender` = @p9, `IsDeleted` = @p10, `LastName` = @p11, `LocationID` = @p12, `LockoutEnabled` = @p13, `LockoutEnd` = @p14, `NormalizedEmail` = @p15, `NormalizedUserName` = @p16, `PasswordHash` = @p17, `PhoneNumber` = @p18, `PhoneNumberConfirmed` = @p19, `ProfilePictureUrl` = @p20, `RefreshToken` = @p21, `RefreshTokenExpiryTime` = @p22, `SecurityStamp` = @p23, `TwoFactorEnabled` = @p24, `UserName` = @p25
WHERE `Id` = @p26 AND `ConcurrencyStamp` = @p27 AND `RowVersion` = @p28;
SELECT `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p26;
2025-03-03 14:56:34.892 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 14:56:34.916 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 14:56:34.934 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 14:56:34.955 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 14:56:34.979 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 14:56:35.006 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (Size = 255), @p26='?' (Size = 255), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p27='?' (Size = 4000), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (DbType = Boolean), @p11='?' (Size = 100), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = DateTimeOffset), @p15='?' (Size = 256), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (Size = 500), @p21='?' (Size = 4000), @p22='?' (DbType = DateTime), @p28='?' (DbType = DateTime), @p23='?' (Size = 4000), @p24='?' (DbType = Boolean), @p25='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserRoles` (`RoleId`, `UserId`)
VALUES (@p0, @p1);
UPDATE `AspNetUsers` SET `AccessFailedCount` = @p2, `ConcurrencyStamp` = @p3, `CreatedDate` = @p4, `DateOfBirth` = @p5, `Email` = @p6, `EmailConfirmed` = @p7, `FirstName` = @p8, `Gender` = @p9, `IsDeleted` = @p10, `LastName` = @p11, `LocationID` = @p12, `LockoutEnabled` = @p13, `LockoutEnd` = @p14, `NormalizedEmail` = @p15, `NormalizedUserName` = @p16, `PasswordHash` = @p17, `PhoneNumber` = @p18, `PhoneNumberConfirmed` = @p19, `ProfilePictureUrl` = @p20, `RefreshToken` = @p21, `RefreshTokenExpiryTime` = @p22, `SecurityStamp` = @p23, `TwoFactorEnabled` = @p24, `UserName` = @p25
WHERE `Id` = @p26 AND `ConcurrencyStamp` = @p27 AND `RowVersion` = @p28;
SELECT `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p26;
2025-03-03 14:56:35.035 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-03-03 14:56:35.043 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.AdminController.AssignUserRole (PillSpot.Presentation) in 700.4801ms
2025-03-03 14:56:35.051 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.AdminController.AssignUserRole (PillSpot.Presentation)'
2025-03-03 14:56:35.062 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/Admin/assign-user-role - 204 null null 843.1513ms
2025-03-03 14:57:35.735 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/permissions-management/create - application/json-patch+json 19
2025-03-03 14:57:35.806 +02:00 [INF] CORS policy execution successful.
2025-03-03 14:57:35.823 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation)'
2025-03-03 14:57:35.848 +02:00 [INF] Route matched with {action = "CreatePermission", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreatePermission(Shared.DataTransferObjects.CreatePermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 14:57:35.967 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation) in 108.4114ms
2025-03-03 14:57:35.974 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation)'
2025-03-03 14:57:35.984 +02:00 [ERR] An unhandled exception has occurred while executing the request.
AutoMapper.AutoMapperMappingException: Missing type map configuration or unsupported mapping.

Mapping types:
CreatePermissionDto -> Permission
Shared.DataTransferObjects.CreatePermissionDto -> Entities.Models.Permission
   at lambda_method562(Closure, Object, Permission, ResolutionContext)
   at Service.PermissionService.CreatePermissionAsync(CreatePermissionDto permissionDto) in E:\GP\Back\Pill-Spot\Service\PermissionService.cs:line 23
   at PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission(CreatePermissionDto permissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 71
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 14:57:36.120 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/permissions-management/create - 500 null text/plain; charset=utf-8 384.6188ms
2025-03-03 14:59:00.078 +02:00 [INF] Application Started!
2025-03-03 14:59:00.676 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 14:59:01.033 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 14:59:01.127 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 14:59:01.422 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 14:59:01.861 +02:00 [INF] Hosting environment: Development
2025-03-03 14:59:01.890 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 14:59:02.260 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 14:59:02.760 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 502.9491ms
2025-03-03 14:59:03.188 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 14:59:03.207 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 18.7163ms
2025-03-03 14:59:03.333 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 14:59:03.349 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 14:59:03.386 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 52.9522ms
2025-03-03 14:59:03.469 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 119.6929ms
2025-03-03 14:59:04.026 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 14:59:04.240 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 214.7182ms
2025-03-03 14:59:43.594 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/permissions-management/create - application/json-patch+json 19
2025-03-03 14:59:43.634 +02:00 [INF] CORS policy execution successful.
2025-03-03 14:59:43.767 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation)'
2025-03-03 14:59:43.890 +02:00 [INF] Route matched with {action = "CreatePermission", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreatePermission(Shared.DataTransferObjects.CreatePermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 14:59:45.370 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation) in 1441.057ms
2025-03-03 14:59:45.379 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation)'
2025-03-03 14:59:45.384 +02:00 [ERR] An unhandled exception has occurred while executing the request.
AutoMapper.AutoMapperMappingException: Missing type map configuration or unsupported mapping.

Mapping types:
CreatePermissionDto -> Permission
Shared.DataTransferObjects.CreatePermissionDto -> Entities.Models.Permission
   at lambda_method53(Closure, Object, Permission, ResolutionContext)
   at Service.PermissionService.CreatePermissionAsync(CreatePermissionDto permissionDto) in E:\GP\Back\Pill-Spot\Service\PermissionService.cs:line 23
   at PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission(CreatePermissionDto permissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 71
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 14:59:45.467 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/permissions-management/create - 500 null text/plain; charset=utf-8 1873.2769ms
2025-03-03 15:01:02.191 +02:00 [INF] Application Started!
2025-03-03 15:01:02.793 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 15:01:03.675 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 15:01:03.692 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 15:01:04.082 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 15:01:04.264 +02:00 [INF] Hosting environment: Development
2025-03-03 15:01:04.266 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 15:01:04.760 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 15:01:05.654 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 898.1498ms
2025-03-03 15:01:05.843 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 15:01:05.919 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 15:01:05.930 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 15:01:06.007 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 88.2246ms
2025-03-03 15:01:06.058 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 214.9516ms
2025-03-03 15:01:06.203 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 272.4569ms
2025-03-03 15:01:06.397 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 15:01:06.638 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 240.9915ms
2025-03-03 15:01:22.458 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/permissions-management/create - application/json-patch+json 19
2025-03-03 15:01:22.542 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:01:22.631 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation)'
2025-03-03 15:01:22.708 +02:00 [INF] Route matched with {action = "CreatePermission", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreatePermission(Shared.DataTransferObjects.CreatePermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:01:27.942 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:27.950 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:27.955 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:27.964 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:27.970 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:27.975 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:27.984 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:27.990 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:27.998 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:28.003 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:28.009 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:28.017 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:28.023 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:28.031 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:01:28.301 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 15:01:28.307 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 15:01:30.382 +02:00 [INF] Executed DbCommand (120ms) [Parameters=[@p0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Permissions` (`Name`)
VALUES (@p0);
SELECT `PermissionId`
FROM `Permissions`
WHERE ROW_COUNT() = 1 AND `PermissionId` = LAST_INSERT_ID();
2025-03-03 15:01:30.566 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Shared.DataTransferObjects.PermissionDto'.
2025-03-03 15:01:30.645 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation) in 7917.3873ms
2025-03-03 15:01:30.651 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation)'
2025-03-03 15:01:30.698 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/permissions-management/create - 201 null application/json; charset=utf-8 8240.0668ms
2025-03-03 15:01:57.769 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/permissions-management/create-collection - application/json-patch+json 51
2025-03-03 15:01:57.863 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:01:57.878 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.CreatePermissionCollection (PillSpot.Presentation)'
2025-03-03 15:01:57.911 +02:00 [INF] Route matched with {action = "CreatePermissionCollection", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreatePermissionCollection(System.Collections.Generic.IEnumerable`1[Shared.DataTransferObjects.CreatePermissionDto]) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:01:58.414 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 50), @p1='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Permissions` (`Name`)
VALUES (@p0);
SELECT `PermissionId`
FROM `Permissions`
WHERE ROW_COUNT() = 1 AND `PermissionId` = LAST_INSERT_ID();

INSERT INTO `Permissions` (`Name`)
VALUES (@p1);
SELECT `PermissionId`
FROM `Permissions`
WHERE ROW_COUNT() = 1 AND `PermissionId` = LAST_INSERT_ID();
2025-03-03 15:01:58.474 +02:00 [INF] Executing CreatedResult, writing value of type 'null'.
2025-03-03 15:01:58.478 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.CreatePermissionCollection (PillSpot.Presentation) in 553.6916ms
2025-03-03 15:01:58.483 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.CreatePermissionCollection (PillSpot.Presentation)'
2025-03-03 15:01:58.493 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/permissions-management/create-collection - 204 null null 724.6188ms
2025-03-03 15:02:10.300 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/permissions-management/create - application/json-patch+json 23
2025-03-03 15:02:10.370 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:02:10.396 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation)'
2025-03-03 15:02:10.400 +02:00 [INF] Route matched with {action = "CreatePermission", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreatePermission(Shared.DataTransferObjects.CreatePermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:02:10.629 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Permissions` (`Name`)
VALUES (@p0);
SELECT `PermissionId`
FROM `Permissions`
WHERE ROW_COUNT() = 1 AND `PermissionId` = LAST_INSERT_ID();
2025-03-03 15:02:10.665 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Shared.DataTransferObjects.PermissionDto'.
2025-03-03 15:02:10.682 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation) in 267.3954ms
2025-03-03 15:02:10.701 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation)'
2025-03-03 15:02:10.718 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/permissions-management/create - 201 null application/json; charset=utf-8 418.2425ms
2025-03-03 15:02:16.221 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/permissions-management/create - application/json-patch+json 23
2025-03-03 15:02:16.235 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:02:16.254 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation)'
2025-03-03 15:02:16.293 +02:00 [INF] Route matched with {action = "CreatePermission", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreatePermission(Shared.DataTransferObjects.CreatePermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:02:16.437 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Permissions` (`Name`)
VALUES (@p0);
SELECT `PermissionId`
FROM `Permissions`
WHERE ROW_COUNT() = 1 AND `PermissionId` = LAST_INSERT_ID();
2025-03-03 15:02:16.453 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Shared.DataTransferObjects.PermissionDto'.
2025-03-03 15:02:16.459 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation) in 129.8531ms
2025-03-03 15:02:16.473 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.CreatePermission (PillSpot.Presentation)'
2025-03-03 15:02:16.481 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/permissions-management/create - 201 null application/json; charset=utf-8 260.05ms
2025-03-03 15:02:26.807 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/api/SuperAdmin/permissions-management/get-all - null null
2025-03-03 15:02:26.837 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetAllPermissions (PillSpot.Presentation)'
2025-03-03 15:02:26.918 +02:00 [INF] Route matched with {action = "GetAllPermissions", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllPermissions(Shared.RequestFeatures.PermissionParameters) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:02:27.976 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PermissionId`, `p`.`Name`
FROM `Permissions` AS `p`
ORDER BY `p`.`Name`
LIMIT @__p_1 OFFSET @__p_0
2025-03-03 15:02:28.207 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM `Permissions` AS `p`
2025-03-03 15:02:28.266 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Shared.DataTransferObjects.PermissionDto, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-03 15:02:28.280 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.GetAllPermissions (PillSpot.Presentation) in 1348.8038ms
2025-03-03 15:02:28.301 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetAllPermissions (PillSpot.Presentation)'
2025-03-03 15:02:28.312 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/api/SuperAdmin/permissions-management/get-all - 200 null application/json; charset=utf-8 1505.0151ms
2025-03-03 15:02:42.022 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/api/SuperAdmin/permissions-management/get-all?OrderBy=ID - null null
2025-03-03 15:02:42.037 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetAllPermissions (PillSpot.Presentation)'
2025-03-03 15:02:42.171 +02:00 [INF] Route matched with {action = "GetAllPermissions", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllPermissions(Shared.RequestFeatures.PermissionParameters) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:02:42.320 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PermissionId`, `p`.`Name`
FROM `Permissions` AS `p`
ORDER BY `p`.`Name`
LIMIT @__p_1 OFFSET @__p_0
2025-03-03 15:02:42.339 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM `Permissions` AS `p`
2025-03-03 15:02:42.354 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Shared.DataTransferObjects.PermissionDto, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-03 15:02:42.364 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.GetAllPermissions (PillSpot.Presentation) in 159.0381ms
2025-03-03 15:02:42.377 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetAllPermissions (PillSpot.Presentation)'
2025-03-03 15:02:42.386 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/api/SuperAdmin/permissions-management/get-all?OrderBy=ID - 200 null application/json; charset=utf-8 363.7341ms
2025-03-03 15:02:58.648 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - application/json-patch+json 76
2025-03-03 15:02:58.668 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:02:58.703 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 15:02:58.737 +02:00 [INF] Route matched with {action = "AssignPermissionToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToAdmin(Shared.DataTransferObjects.AssignAdminPermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:02:59.107 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:02:59.655 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:02:59.746 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:02:59.761 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation) in 1011.5178ms
2025-03-03 15:02:59.765 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 15:02:59.771 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.NotAnAdminException: User with ID 'ac7a2899-ef9d-40cf-836f-fce4e7a322c4' is not an admin.
   at Service.AdminPermissionService.AssignPermissionToAdminAsync(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 36
   at PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 105
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 15:02:59.839 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - 500 null text/plain; charset=utf-8 1194.1091ms
2025-03-03 15:03:15.223 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - application/json-patch+json 76
2025-03-03 15:03:15.235 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:03:15.239 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 15:03:15.243 +02:00 [INF] Route matched with {action = "AssignPermissionToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToAdmin(Shared.DataTransferObjects.AssignAdminPermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:03:15.436 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:03:15.459 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:03:15.485 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:03:15.813 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `AdminPermissions` (`AdminId`, `PermissionId`)
VALUES (@p0, @p1);
2025-03-03 15:03:15.830 +02:00 [INF] Executing CreatedAtRouteResult, writing value of type 'Shared.DataTransferObjects.AdminPermissionDto'.
2025-03-03 15:03:15.838 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation) in 588.6576ms
2025-03-03 15:03:15.846 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 15:03:15.852 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - 201 null application/json; charset=utf-8 629.4032ms
2025-03-03 15:03:37.648 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - null null
2025-03-03 15:03:37.701 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:03:37.727 +02:00 [INF] Route matched with {action = "GetPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPermissionsToAdmin(System.String) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:03:38.064 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminId`, `a`.`PermissionId`, `p`.`PermissionId`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionId` = `p`.`PermissionId`
WHERE `a`.`AdminId` = @__adminId_0
2025-03-03 15:03:38.087 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[Entities.Models.AdminPermission, Entities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Shared.DataTransferObjects.PermissionDto, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-03 15:03:38.100 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation) in 363.9181ms
2025-03-03 15:03:38.114 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:03:38.122 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - 200 null application/json; charset=utf-8 473.7854ms
2025-03-03 15:03:52.832 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign-multiple/2231ad46-5d96-4eac-8b98-3ce8475e9922 - application/json-patch+json 11
2025-03-03 15:03:53.021 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:03:53.024 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:03:53.056 +02:00 [INF] Route matched with {action = "AssignPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionsToAdmin(System.String, System.Collections.Generic.IEnumerable`1[System.Int32]) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:03:53.204 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (Size = 255), @p3='?' (DbType = Int32), @p4='?' (Size = 255), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `AdminPermissions` (`AdminId`, `PermissionId`)
VALUES (@p0, @p1),
(@p2, @p3),
(@p4, @p5);
2025-03-03 15:03:53.240 +02:00 [INF] Executing CreatedAtRouteResult, writing value of type 'System.Collections.Generic.List`1[[Shared.DataTransferObjects.AdminPermissionDto, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-03 15:03:53.265 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin (PillSpot.Presentation) in 190.0419ms
2025-03-03 15:03:53.284 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:03:53.299 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign-multiple/2231ad46-5d96-4eac-8b98-3ce8475e9922 - 201 null application/json; charset=utf-8 463.9915ms
2025-03-03 15:04:00.178 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - null null
2025-03-03 15:04:00.213 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:04:00.226 +02:00 [INF] Route matched with {action = "GetPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPermissionsToAdmin(System.String) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:04:00.330 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminId`, `a`.`PermissionId`, `p`.`PermissionId`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionId` = `p`.`PermissionId`
WHERE `a`.`AdminId` = @__adminId_0
2025-03-03 15:04:00.367 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[Entities.Models.AdminPermission, Entities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Shared.DataTransferObjects.PermissionDto, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-03 15:04:00.406 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation) in 162.6425ms
2025-03-03 15:04:00.440 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:04:00.472 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - 200 null application/json; charset=utf-8 294.4669ms
2025-03-03 15:04:19.758 +02:00 [INF] Request starting HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove-multiple/2231ad46-5d96-4eac-8b98-3ce8475e9922 - application/json-patch+json 9
2025-03-03 15:04:19.771 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:04:19.781 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation)'
2025-03-03 15:04:19.840 +02:00 [INF] Route matched with {action = "RemovePermissionsFromAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RemovePermissionsFromAdmin(System.String, System.Collections.Generic.IEnumerable`1[System.Int32]) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:04:20.019 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminId`, `a`.`PermissionId`, `p`.`PermissionId`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionId` = `p`.`PermissionId`
WHERE (`a`.`AdminId` = @__adminId_0) AND `a`.`PermissionId` IN (1, 2)
2025-03-03 15:04:20.115 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (Size = 255), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `AdminPermissions`
WHERE `AdminId` = @p0 AND `PermissionId` = @p1;
SELECT ROW_COUNT();

DELETE FROM `AdminPermissions`
WHERE `AdminId` = @p2 AND `PermissionId` = @p3;
SELECT ROW_COUNT();
2025-03-03 15:04:20.190 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-03-03 15:04:20.193 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation) in 339.7363ms
2025-03-03 15:04:20.202 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation)'
2025-03-03 15:04:20.212 +02:00 [INF] Request finished HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove-multiple/2231ad46-5d96-4eac-8b98-3ce8475e9922 - 204 null null 453.8571ms
2025-03-03 15:04:24.698 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - null null
2025-03-03 15:04:24.772 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:04:24.789 +02:00 [INF] Route matched with {action = "GetPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPermissionsToAdmin(System.String) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:04:24.889 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminId`, `a`.`PermissionId`, `p`.`PermissionId`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionId` = `p`.`PermissionId`
WHERE `a`.`AdminId` = @__adminId_0
2025-03-03 15:04:24.904 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[Entities.Models.AdminPermission, Entities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Shared.DataTransferObjects.PermissionDto, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-03 15:04:24.912 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation) in 105.4618ms
2025-03-03 15:04:24.923 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:04:24.930 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - 200 null application/json; charset=utf-8 232.7688ms
2025-03-03 15:15:15.439 +02:00 [INF] Application Started!
2025-03-03 15:15:16.045 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 15:15:16.537 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 15:15:16.552 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 15:15:16.868 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 15:15:16.887 +02:00 [INF] Hosting environment: Development
2025-03-03 15:15:16.893 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 15:15:17.050 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 15:15:17.665 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 617.7716ms
2025-03-03 15:15:17.973 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 15:15:17.973 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 15:15:17.975 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 15:15:18.018 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 44.6973ms
2025-03-03 15:15:18.041 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 68.0799ms
2025-03-03 15:15:18.227 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 252.6505ms
2025-03-03 15:15:18.467 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 15:15:18.903 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 436.6794ms
2025-03-03 15:15:55.174 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - application/json-patch+json 76
2025-03-03 15:15:55.207 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:15:55.356 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 15:15:55.542 +02:00 [INF] Route matched with {action = "AssignPermissionToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToAdmin(Shared.DataTransferObjects.AssignAdminPermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:16:00.947 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:00.952 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:00.961 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:00.965 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:00.971 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:00.977 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:00.982 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:00.987 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:00.994 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:00.999 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:01.005 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:01.013 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:01.019 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:01.025 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 15:16:01.295 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 15:16:01.301 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 15:16:03.502 +02:00 [INF] Executed DbCommand (160ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:16:04.166 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:16:04.267 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:16:04.299 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation) in 8710.2819ms
2025-03-03 15:16:04.305 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 15:16:04.316 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.NotAnAdminException: User with ID 'ac7a2899-ef9d-40cf-836f-fce4e7a322c4' is not an admin.
   at Service.AdminPermissionService.AssignPermissionToAdminAsync(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 32
   at PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 105
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 15:16:04.417 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - 500 null text/plain; charset=utf-8 9243.6172ms
2025-03-03 15:16:22.509 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - application/json-patch+json 76
2025-03-03 15:16:22.668 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:16:22.685 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 15:16:22.701 +02:00 [INF] Route matched with {action = "AssignPermissionToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToAdmin(Shared.DataTransferObjects.AssignAdminPermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:16:23.190 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:16:23.223 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:16:23.262 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:16:23.982 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `AdminPermissions` (`AdminId`, `PermissionId`)
VALUES (@p0, @p1);
2025-03-03 15:16:24.114 +02:00 [INF] Executing CreatedAtRouteResult, writing value of type 'Shared.DataTransferObjects.AdminPermissionDto'.
2025-03-03 15:16:24.194 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation) in 1473.4221ms
2025-03-03 15:16:24.208 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 15:16:24.216 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - 201 null application/json; charset=utf-8 1706.6483ms
2025-03-03 15:16:37.010 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign-multiple/ac7a2899-ef9d-40cf-836f-fce4e7a322c4 - application/json-patch+json 9
2025-03-03 15:16:37.044 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:16:37.057 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:16:37.106 +02:00 [INF] Route matched with {action = "AssignPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionsToAdmin(System.String, System.Collections.Generic.IEnumerable`1[System.Int32]) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:16:37.389 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:16:37.416 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:16:37.438 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:16:37.453 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin (PillSpot.Presentation) in 335.1979ms
2025-03-03 15:16:37.459 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:16:37.465 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.NotAnAdminException: User with ID 'ac7a2899-ef9d-40cf-836f-fce4e7a322c4' is not an admin.
   at Service.AdminPermissionService.AssignPermissionsToAdminAsync(String adminId, IEnumerable`1 permissionIds) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 43
   at PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin(String adminId, IEnumerable`1 permissionIds) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 112
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 15:16:37.518 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign-multiple/ac7a2899-ef9d-40cf-836f-fce4e7a322c4 - 500 null text/plain; charset=utf-8 507.9612ms
2025-03-03 15:16:53.877 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign-multiple/2231ad46-5d96-4eac-8b98-3ce8475e9922 - application/json-patch+json 7
2025-03-03 15:16:53.972 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:16:53.982 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:16:54.002 +02:00 [INF] Route matched with {action = "AssignPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionsToAdmin(System.String, System.Collections.Generic.IEnumerable`1[System.Int32]) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:16:54.190 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:16:54.418 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:16:54.445 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:16:54.500 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `AdminPermissions` (`AdminId`, `PermissionId`)
VALUES (@p0, @p1);
2025-03-03 15:16:54.556 +02:00 [INF] Executing CreatedAtRouteResult, writing value of type 'System.Collections.Generic.List`1[[Shared.DataTransferObjects.AdminPermissionDto, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-03 15:16:54.576 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin (PillSpot.Presentation) in 537.5394ms
2025-03-03 15:16:54.599 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:16:54.606 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign-multiple/2231ad46-5d96-4eac-8b98-3ce8475e9922 - 201 null application/json; charset=utf-8 728.582ms
2025-03-03 15:17:03.082 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/ac7a2899-ef9d-40cf-836f-fce4e7a322c4 - null null
2025-03-03 15:17:03.239 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:17:03.259 +02:00 [INF] Route matched with {action = "GetPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPermissionsToAdmin(System.String) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:17:03.362 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:17:03.377 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:17:03.393 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:17:03.407 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation) in 132.141ms
2025-03-03 15:17:03.412 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:17:03.415 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.NotAnAdminException: User with ID 'ac7a2899-ef9d-40cf-836f-fce4e7a322c4' is not an admin.
   at Service.AdminPermissionService.GetPermissionsToAdminAsync(String adminId, Boolean trackChanges) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 60
   at PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin(String adminId) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 119
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 15:17:03.468 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/ac7a2899-ef9d-40cf-836f-fce4e7a322c4 - 500 null text/plain; charset=utf-8 386.104ms
2025-03-03 15:17:09.701 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - null null
2025-03-03 15:17:09.723 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:17:09.786 +02:00 [INF] Route matched with {action = "GetPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPermissionsToAdmin(System.String) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:17:09.892 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:17:09.921 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:17:09.955 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:17:10.272 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminId`, `a`.`PermissionId`, `p`.`PermissionId`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionId` = `p`.`PermissionId`
WHERE `a`.`AdminId` = @__adminId_0
2025-03-03 15:17:10.301 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[Entities.Models.AdminPermission, Entities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Shared.DataTransferObjects.PermissionDto, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-03 15:17:10.320 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation) in 512.1002ms
2025-03-03 15:17:10.330 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:17:10.345 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - 200 null application/json; charset=utf-8 643.5315ms
2025-03-03 15:17:30.308 +02:00 [INF] Request starting HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove/ac7a2899-ef9d-40cf-836f-fce4e7a322c4/2 - null null
2025-03-03 15:17:30.346 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:17:30.358 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin (PillSpot.Presentation)'
2025-03-03 15:17:30.397 +02:00 [INF] Route matched with {action = "RemovePermissionFromAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RemovePermissionFromAdmin(System.String, Int32) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:17:30.498 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:17:30.511 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:17:30.523 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:17:30.535 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin (PillSpot.Presentation) in 123.5766ms
2025-03-03 15:17:30.539 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin (PillSpot.Presentation)'
2025-03-03 15:17:30.545 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.NotAnAdminException: User with ID 'ac7a2899-ef9d-40cf-836f-fce4e7a322c4' is not an admin.
   at Service.AdminPermissionService.RemovePermissionFromAdminAsync(String adminId, Int32 permissionId) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 75
   at PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin(String adminId, Int32 permissionId) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 126
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 15:17:30.586 +02:00 [INF] Request finished HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove/ac7a2899-ef9d-40cf-836f-fce4e7a322c4/2 - 500 null text/plain; charset=utf-8 278.3982ms
2025-03-03 15:17:43.973 +02:00 [INF] Request starting HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove/2231ad46-5d96-4eac-8b98-3ce8475e9922/4 - null null
2025-03-03 15:17:44.005 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:17:44.008 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin (PillSpot.Presentation)'
2025-03-03 15:17:44.018 +02:00 [INF] Route matched with {action = "RemovePermissionFromAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RemovePermissionFromAdmin(System.String, Int32) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:17:44.122 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:17:44.150 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:17:44.176 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:17:44.208 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminId`, `a`.`PermissionId`, `p`.`PermissionId`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionId` = `p`.`PermissionId`
WHERE `a`.`AdminId` = @__adminId_0
2025-03-03 15:17:44.390 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
DELETE FROM `AdminPermissions`
WHERE `AdminId` = @p0 AND `PermissionId` = @p1;
SELECT ROW_COUNT();
2025-03-03 15:17:44.499 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-03-03 15:17:44.504 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin (PillSpot.Presentation) in 474.4764ms
2025-03-03 15:17:44.509 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionFromAdmin (PillSpot.Presentation)'
2025-03-03 15:17:44.515 +02:00 [INF] Request finished HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove/2231ad46-5d96-4eac-8b98-3ce8475e9922/4 - 204 null null 541.8157ms
2025-03-03 15:17:51.657 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - null null
2025-03-03 15:17:51.698 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:17:51.708 +02:00 [INF] Route matched with {action = "GetPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPermissionsToAdmin(System.String) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:17:51.796 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:17:51.816 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:17:51.830 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:17:51.842 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminId`, `a`.`PermissionId`, `p`.`PermissionId`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionId` = `p`.`PermissionId`
WHERE `a`.`AdminId` = @__adminId_0
2025-03-03 15:17:51.851 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[Entities.Models.AdminPermission, Entities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Shared.DataTransferObjects.PermissionDto, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-03 15:17:51.859 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation) in 141.0863ms
2025-03-03 15:17:51.868 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:17:51.875 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - 200 null application/json; charset=utf-8 218.1868ms
2025-03-03 15:18:04.037 +02:00 [INF] Request starting HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove-multiple/ac7a2899-ef9d-40cf-836f-fce4e7a322c4 - application/json-patch+json 7
2025-03-03 15:18:04.158 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:18:04.170 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation)'
2025-03-03 15:18:04.188 +02:00 [INF] Route matched with {action = "RemovePermissionsFromAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RemovePermissionsFromAdmin(System.String, System.Collections.Generic.IEnumerable`1[System.Int32]) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:18:04.285 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:18:04.299 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:18:04.309 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:18:04.320 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation) in 119.8185ms
2025-03-03 15:18:04.324 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation)'
2025-03-03 15:18:04.333 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.NotAnAdminException: User with ID 'ac7a2899-ef9d-40cf-836f-fce4e7a322c4' is not an admin.
   at Service.AdminPermissionService.RemovePermissionsFromAdminAsync(String adminId, IEnumerable`1 permissionIds) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 90
   at PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin(String adminId, IEnumerable`1 permissionIds) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 133
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 15:18:04.372 +02:00 [INF] Request finished HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove-multiple/ac7a2899-ef9d-40cf-836f-fce4e7a322c4 - 500 null text/plain; charset=utf-8 335.5385ms
2025-03-03 15:18:16.026 +02:00 [INF] Request starting HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove-multiple/2231ad46-5d96-4eac-8b98-3ce8475e9922 - application/json-patch+json 9
2025-03-03 15:18:16.142 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:18:16.171 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation)'
2025-03-03 15:18:16.179 +02:00 [INF] Route matched with {action = "RemovePermissionsFromAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RemovePermissionsFromAdmin(System.String, System.Collections.Generic.IEnumerable`1[System.Int32]) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:18:16.281 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:18:16.343 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:18:16.395 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:18:16.562 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminId`, `a`.`PermissionId`, `p`.`PermissionId`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionId` = `p`.`PermissionId`
WHERE (`a`.`AdminId` = @__adminId_0) AND `a`.`PermissionId` IN (2, 3)
2025-03-03 15:18:16.658 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (Size = 255), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `AdminPermissions`
WHERE `AdminId` = @p0 AND `PermissionId` = @p1;
SELECT ROW_COUNT();

DELETE FROM `AdminPermissions`
WHERE `AdminId` = @p2 AND `PermissionId` = @p3;
SELECT ROW_COUNT();
2025-03-03 15:18:16.713 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-03-03 15:18:16.721 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation) in 524.5887ms
2025-03-03 15:18:16.725 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation)'
2025-03-03 15:18:16.729 +02:00 [INF] Request finished HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove-multiple/2231ad46-5d96-4eac-8b98-3ce8475e9922 - 204 null null 703.5721ms
2025-03-03 15:18:21.243 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - null null
2025-03-03 15:18:21.253 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:18:21.283 +02:00 [INF] Route matched with {action = "GetPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPermissionsToAdmin(System.String) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:18:21.406 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:18:21.457 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:18:21.483 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:18:21.514 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminId`, `a`.`PermissionId`, `p`.`PermissionId`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionId` = `p`.`PermissionId`
WHERE `a`.`AdminId` = @__adminId_0
2025-03-03 15:18:21.540 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[Entities.Models.AdminPermission, Entities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Shared.DataTransferObjects.PermissionDto, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-03 15:18:21.565 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation) in 259.2132ms
2025-03-03 15:18:21.583 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 15:18:21.589 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - 200 null application/json; charset=utf-8 345.7246ms
2025-03-03 15:20:40.979 +02:00 [INF] Request starting HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove-multiple/2231ad46-5d96-4eac-8b98-3ce8475e9922 - application/json-patch+json 9
2025-03-03 15:20:41.119 +02:00 [INF] CORS policy execution successful.
2025-03-03 15:20:41.124 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation)'
2025-03-03 15:20:41.136 +02:00 [INF] Route matched with {action = "RemovePermissionsFromAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RemovePermissionsFromAdmin(System.String, System.Collections.Generic.IEnumerable`1[System.Int32]) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 15:20:41.310 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 15:20:41.397 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 15:20:41.816 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 15:20:41.839 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminId`, `a`.`PermissionId`, `p`.`PermissionId`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionId` = `p`.`PermissionId`
WHERE (`a`.`AdminId` = @__adminId_0) AND `a`.`PermissionId` IN (2, 3)
2025-03-03 15:20:41.854 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation) in 683.4089ms
2025-03-03 15:20:41.866 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin (PillSpot.Presentation)'
2025-03-03 15:20:41.876 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.AdminPermissionNotFoundException: No permissions found for Admin with ID: 2231ad46-5d96-4eac-8b98-3ce8475e9922.
   at Service.AdminPermissionService.RemovePermissionsFromAdminAsync(String adminId, IEnumerable`1 permissionIds) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 98
   at PillSpot.Presentation.Controllers.SuperAdminController.RemovePermissionsFromAdmin(String adminId, IEnumerable`1 permissionIds) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 133
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 15:20:41.936 +02:00 [INF] Request finished HTTP/2 DELETE https://localhost:7298/api/SuperAdmin/admin-permission/remove-multiple/2231ad46-5d96-4eac-8b98-3ce8475e9922 - 500 null text/plain; charset=utf-8 957.221ms
2025-03-03 20:13:42.007 +02:00 [INF] Application Started!
2025-03-03 20:13:42.977 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 20:13:43.371 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 20:13:43.376 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 20:13:43.606 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 20:13:43.896 +02:00 [INF] Hosting environment: Development
2025-03-03 20:13:43.935 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 20:13:44.783 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 20:13:45.719 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 939.389ms
2025-03-03 20:13:45.880 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 20:13:45.882 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 20:13:45.893 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 20:13:45.939 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 56.7272ms
2025-03-03 20:13:46.003 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 123.8699ms
2025-03-03 20:13:46.134 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 240.5933ms
2025-03-03 20:13:46.348 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 20:13:46.565 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 216.9697ms
2025-03-03 20:15:19.268 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - application/json-patch+json 76
2025-03-03 20:15:19.400 +02:00 [INF] CORS policy execution successful.
2025-03-03 20:15:19.572 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 20:15:19.656 +02:00 [INF] Route matched with {action = "AssignPermissionToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToAdmin(Shared.DataTransferObjects.AssignAdminPermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 20:15:24.736 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.743 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.749 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.753 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.759 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.765 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.770 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.779 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.784 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.790 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.798 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.803 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.811 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:24.816 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 20:15:25.068 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 20:15:25.077 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 20:15:27.214 +02:00 [INF] Executed DbCommand (143ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 20:15:27.848 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 20:15:27.934 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 20:15:27.965 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation) in 8284.968ms
2025-03-03 20:15:27.970 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 20:15:27.982 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.NotAnAdminException: User with ID 'ac7a2899-ef9d-40cf-836f-fce4e7a322c4' is not an admin.
   at Service.AdminPermissionService.AssignPermissionToAdminAsync(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 32
   at PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 105
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 20:15:28.101 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - 500 null text/plain; charset=utf-8 8832.7815ms
2025-03-03 20:15:38.527 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - application/json-patch+json 76
2025-03-03 20:15:38.570 +02:00 [INF] CORS policy execution successful.
2025-03-03 20:15:38.592 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 20:15:38.608 +02:00 [INF] Route matched with {action = "AssignPermissionToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToAdmin(Shared.DataTransferObjects.AssignAdminPermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 20:15:39.025 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 20:15:39.170 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 20:15:39.204 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 20:15:39.474 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__adminId_0='?' (Size = 255), @__permissionId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AdminPermissions` AS `a`
    WHERE (`a`.`AdminId` = @__adminId_0) AND (`a`.`PermissionId` = @__permissionId_1))
2025-03-03 20:15:39.521 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation) in 895.3998ms
2025-03-03 20:15:39.526 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 20:15:39.536 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.AdminPermissionAlreadyAssignedException: Admin with ID 2231ad46-5d96-4eac-8b98-3ce8475e9922 already has one of the assigned permissions: 1.
   at Service.AdminPermissionService.AssignPermissionToAdminAsync(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\Service\AdminPermissionService.cs:line 35
   at PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin(AssignAdminPermissionDto assignAdminPermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\SuperAdminController.cs:line 105
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 20:15:39.609 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - 500 null text/plain; charset=utf-8 1082.4614ms
2025-03-03 20:15:52.950 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - application/json-patch+json 76
2025-03-03 20:15:53.089 +02:00 [INF] CORS policy execution successful.
2025-03-03 20:15:53.103 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 20:15:53.109 +02:00 [INF] Route matched with {action = "AssignPermissionToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToAdmin(Shared.DataTransferObjects.AssignAdminPermissionDto) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 20:15:53.307 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 20:15:53.328 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 20:15:53.347 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 20:15:53.369 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__adminId_0='?' (Size = 255), @__permissionId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AdminPermissions` AS `a`
    WHERE (`a`.`AdminId` = @__adminId_0) AND (`a`.`PermissionId` = @__permissionId_1))
2025-03-03 20:15:53.950 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `AdminPermissions` (`AdminId`, `PermissionId`)
VALUES (@p0, @p1);
2025-03-03 20:15:54.043 +02:00 [INF] Executing CreatedAtRouteResult, writing value of type 'Shared.DataTransferObjects.AdminPermissionDto'.
2025-03-03 20:15:54.172 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation) in 1048.3819ms
2025-03-03 20:15:54.183 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.AssignPermissionToAdmin (PillSpot.Presentation)'
2025-03-03 20:15:54.194 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/SuperAdmin/admin-permission/assign - 201 null application/json; charset=utf-8 1244.1214ms
2025-03-03 20:16:06.899 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - null null
2025-03-03 20:16:06.931 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 20:16:06.959 +02:00 [INF] Route matched with {action = "GetPermissionsToAdmin", controller = "SuperAdmin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPermissionsToAdmin(System.String) on controller PillSpot.Presentation.Controllers.SuperAdminController (PillSpot.Presentation).
2025-03-03 20:16:07.064 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 20:16:07.084 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 20:16:07.110 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 20:16:07.335 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__adminId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`AdminId`, `a`.`PermissionId`, `p`.`PermissionId`, `p`.`Name`
FROM `AdminPermissions` AS `a`
INNER JOIN `Permissions` AS `p` ON `a`.`PermissionId` = `p`.`PermissionId`
WHERE `a`.`AdminId` = @__adminId_0
2025-03-03 20:16:07.359 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[Entities.Models.AdminPermission, Entities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Shared.DataTransferObjects.PermissionDto, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-03 20:16:07.380 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation) in 408.2672ms
2025-03-03 20:16:07.392 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.SuperAdminController.GetPermissionsToAdmin (PillSpot.Presentation)'
2025-03-03 20:16:07.402 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/api/SuperAdmin/admin-permission/2231ad46-5d96-4eac-8b98-3ce8475e9922 - 200 null application/json; charset=utf-8 503.2807ms
2025-03-03 20:42:56.054 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/Admin/assign-user-role - application/json-patch+json 81
2025-03-03 20:42:56.286 +02:00 [INF] CORS policy execution successful.
2025-03-03 20:42:56.299 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.AdminController.AssignUserRole (PillSpot.Presentation)'
2025-03-03 20:42:56.332 +02:00 [INF] Route matched with {action = "AssignUserRole", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignUserRole(Shared.DataTransferObjects.AssignUserRoleDto) on controller PillSpot.Presentation.Controllers.AdminController (PillSpot.Presentation).
2025-03-03 20:42:56.530 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 20:42:56.619 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a0`.`Name`
FROM `AspNetUserRoles` AS `a`
INNER JOIN `AspNetRoles` AS `a0` ON `a`.`RoleId` = `a0`.`Id`
WHERE `a`.`UserId` = @__userId_0
2025-03-03 20:42:56.653 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 20:42:56.672 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 20:42:56.713 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 20:42:56.790 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 20:42:56.848 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 20:42:57.062 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (Size = 255), @p26='?' (Size = 255), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p27='?' (Size = 4000), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (DbType = Boolean), @p11='?' (Size = 100), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = DateTimeOffset), @p15='?' (Size = 256), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (Size = 500), @p21='?' (Size = 4000), @p22='?' (DbType = DateTime), @p28='?' (DbType = DateTime), @p23='?' (Size = 4000), @p24='?' (DbType = Boolean), @p25='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `AspNetUserRoles`
WHERE `RoleId` = @p0 AND `UserId` = @p1;
SELECT ROW_COUNT();

UPDATE `AspNetUsers` SET `AccessFailedCount` = @p2, `ConcurrencyStamp` = @p3, `CreatedDate` = @p4, `DateOfBirth` = @p5, `Email` = @p6, `EmailConfirmed` = @p7, `FirstName` = @p8, `Gender` = @p9, `IsDeleted` = @p10, `LastName` = @p11, `LocationID` = @p12, `LockoutEnabled` = @p13, `LockoutEnd` = @p14, `NormalizedEmail` = @p15, `NormalizedUserName` = @p16, `PasswordHash` = @p17, `PhoneNumber` = @p18, `PhoneNumberConfirmed` = @p19, `ProfilePictureUrl` = @p20, `RefreshToken` = @p21, `RefreshTokenExpiryTime` = @p22, `SecurityStamp` = @p23, `TwoFactorEnabled` = @p24, `UserName` = @p25
WHERE `Id` = @p26 AND `ConcurrencyStamp` = @p27 AND `RowVersion` = @p28;
SELECT `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p26;
2025-03-03 20:42:57.217 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 20:42:57.247 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 20:42:57.278 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 20:42:57.302 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 20:42:57.322 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 20:42:57.359 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (Size = 255), @p26='?' (Size = 255), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p27='?' (Size = 4000), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (DbType = Boolean), @p11='?' (Size = 100), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = DateTimeOffset), @p15='?' (Size = 256), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (Size = 500), @p21='?' (Size = 4000), @p22='?' (DbType = DateTime), @p28='?' (DbType = DateTime), @p23='?' (Size = 4000), @p24='?' (DbType = Boolean), @p25='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserRoles` (`RoleId`, `UserId`)
VALUES (@p0, @p1);
UPDATE `AspNetUsers` SET `AccessFailedCount` = @p2, `ConcurrencyStamp` = @p3, `CreatedDate` = @p4, `DateOfBirth` = @p5, `Email` = @p6, `EmailConfirmed` = @p7, `FirstName` = @p8, `Gender` = @p9, `IsDeleted` = @p10, `LastName` = @p11, `LocationID` = @p12, `LockoutEnabled` = @p13, `LockoutEnd` = @p14, `NormalizedEmail` = @p15, `NormalizedUserName` = @p16, `PasswordHash` = @p17, `PhoneNumber` = @p18, `PhoneNumberConfirmed` = @p19, `ProfilePictureUrl` = @p20, `RefreshToken` = @p21, `RefreshTokenExpiryTime` = @p22, `SecurityStamp` = @p23, `TwoFactorEnabled` = @p24, `UserName` = @p25
WHERE `Id` = @p26 AND `ConcurrencyStamp` = @p27 AND `RowVersion` = @p28;
SELECT `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p26;
2025-03-03 20:42:57.399 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-03-03 20:42:57.402 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.AdminController.AssignUserRole (PillSpot.Presentation) in 1051.6153ms
2025-03-03 20:42:57.412 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.AdminController.AssignUserRole (PillSpot.Presentation)'
2025-03-03 20:42:57.417 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/Admin/assign-user-role - 204 null null 1362.3065ms
2025-03-03 20:50:22.157 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/pharmacies - application/json-patch+json 351
2025-03-03 20:50:22.320 +02:00 [INF] CORS policy execution successful.
2025-03-03 20:50:22.367 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-03 20:50:22.393 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-03-03 20:50:22.397 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/pharmacies - 401 0 null 240.2723ms
2025-03-03 20:50:40.013 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/pharmacies - application/json-patch+json 351
2025-03-03 20:50:40.065 +02:00 [INF] CORS policy execution successful.
2025-03-03 20:50:40.134 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-03 20:50:40.147 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-03-03 20:50:40.150 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/pharmacies - 401 0 null 136.8086ms
2025-03-03 20:51:22.315 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/pharmacies - application/json-patch+json 355
2025-03-03 20:51:22.356 +02:00 [INF] CORS policy execution successful.
2025-03-03 20:51:22.376 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-03 20:51:22.390 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-03-03 20:51:22.397 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/pharmacies - 401 0 null 82.076ms
2025-03-03 21:00:19.797 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/pharmacies - application/json-patch+json 355
2025-03-03 21:00:19.891 +02:00 [INF] CORS policy execution successful.
2025-03-03 21:00:19.936 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-03 21:00:19.958 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-03-03 21:00:19.983 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/pharmacies - 401 0 null 186.35ms
2025-03-03 21:05:31.722 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/authentication - multipart/form-data; boundary=----WebKitFormBoundaryqNGDFt340y2QogX6 951
2025-03-03 21:05:31.775 +02:00 [INF] CORS policy execution successful.
2025-03-03 21:05:31.781 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation)'
2025-03-03 21:05:31.826 +02:00 [INF] Route matched with {action = "RegisterUser", controller = "Authentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterUser(Shared.DataTransferObjects.UserForRegistrationDto) on controller PillSpot.Presentation.Controllers.AuthenticationController (PillSpot.Presentation).
2025-03-03 21:05:32.368 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 21:05:32.397 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 21:05:32.464 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (Size = 100), @p8='?' (DbType = Int32), @p9='?' (Size = 100), @p10='?' (DbType = Guid), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 256), @p14='?' (Size = 256), @p15='?' (Size = 4000), @p16='?' (Size = 4000), @p17='?' (DbType = Boolean), @p18='?' (Size = 500), @p19='?' (Size = 4000), @p20='?' (DbType = DateTime), @p21='?' (Size = 4000), @p22='?' (DbType = Boolean), @p23='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUsers` (`Id`, `AccessFailedCount`, `ConcurrencyStamp`, `CreatedDate`, `DateOfBirth`, `Email`, `EmailConfirmed`, `FirstName`, `Gender`, `LastName`, `LocationID`, `LockoutEnabled`, `LockoutEnd`, `NormalizedEmail`, `NormalizedUserName`, `PasswordHash`, `PhoneNumber`, `PhoneNumberConfirmed`, `ProfilePictureUrl`, `RefreshToken`, `RefreshTokenExpiryTime`, `SecurityStamp`, `TwoFactorEnabled`, `UserName`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23);
SELECT `IsDeleted`, `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p0;
2025-03-03 21:05:32.525 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 21:05:32.553 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 21:05:32.572 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 21:05:32.603 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 21:05:32.620 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 21:05:32.646 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (Size = 255), @p26='?' (Size = 255), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p27='?' (Size = 4000), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (DbType = Boolean), @p11='?' (Size = 100), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = DateTimeOffset), @p15='?' (Size = 256), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (Size = 500), @p21='?' (Size = 4000), @p22='?' (DbType = DateTime), @p28='?' (DbType = DateTime), @p23='?' (Size = 4000), @p24='?' (DbType = Boolean), @p25='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserRoles` (`RoleId`, `UserId`)
VALUES (@p0, @p1);
UPDATE `AspNetUsers` SET `AccessFailedCount` = @p2, `ConcurrencyStamp` = @p3, `CreatedDate` = @p4, `DateOfBirth` = @p5, `Email` = @p6, `EmailConfirmed` = @p7, `FirstName` = @p8, `Gender` = @p9, `IsDeleted` = @p10, `LastName` = @p11, `LocationID` = @p12, `LockoutEnabled` = @p13, `LockoutEnd` = @p14, `NormalizedEmail` = @p15, `NormalizedUserName` = @p16, `PasswordHash` = @p17, `PhoneNumber` = @p18, `PhoneNumberConfirmed` = @p19, `ProfilePictureUrl` = @p20, `RefreshToken` = @p21, `RefreshTokenExpiryTime` = @p22, `SecurityStamp` = @p23, `TwoFactorEnabled` = @p24, `UserName` = @p25
WHERE `Id` = @p26 AND `ConcurrencyStamp` = @p27 AND `RowVersion` = @p28;
SELECT `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p26;
2025-03-03 21:05:32.674 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 201
2025-03-03 21:05:32.680 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation) in 843.5105ms
2025-03-03 21:05:32.692 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation)'
2025-03-03 21:05:32.700 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/authentication - 201 0 null 977.914ms
2025-03-03 21:08:07.891 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 21:08:07.989 +02:00 [INF] CORS policy execution successful.
2025-03-03 21:08:07.995 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:08:08.017 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 21:08:08.244 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (DbType = UInt64), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `PharmacyEmployeePermissions` (`EmployeeId`, `PermissionId`)
VALUES (@p0, @p1);
2025-03-03 21:08:08.281 +02:00 [INF] Executing CreatedAtRouteResult, writing value of type 'Shared.DataTransferObjects.EmployeePermissionDto'.
2025-03-03 21:08:08.300 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 272.6035ms
2025-03-03 21:08:08.314 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:08:08.327 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 201 null application/json; charset=utf-8 436.2274ms
2025-03-03 21:08:18.265 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 21:08:18.295 +02:00 [INF] CORS policy execution successful.
2025-03-03 21:08:18.335 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:08:18.351 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 21:08:18.493 +02:00 [ERR] Failed executing DbCommand (18ms) [Parameters=[@p0='?' (DbType = UInt64), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `PharmacyEmployeePermissions` (`EmployeeId`, `PermissionId`)
VALUES (@p0, @p1);
2025-03-03 21:08:18.628 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.RepositoryContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`pharmacyemployeepermissions`, CONSTRAINT `FK_PharmacyEmployeePermissions_PharmacyEmployees_EmployeeId` FOREIGN KEY (`EmployeeId`) REFERENCES `pharmacyemployees` (`EmployeeID`) ON D)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`pharmacyemployeepermissions`, CONSTRAINT `FK_PharmacyEmployeePermissions_PharmacyEmployees_EmployeeId` FOREIGN KEY (`EmployeeId`) REFERENCES `pharmacyemployees` (`EmployeeID`) ON D)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-03 21:08:19.004 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 630.0648ms
2025-03-03 21:08:19.037 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:08:19.163 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`pillspot`.`pharmacyemployeepermissions`, CONSTRAINT `FK_PharmacyEmployeePermissions_PharmacyEmployees_EmployeeId` FOREIGN KEY (`EmployeeId`) REFERENCES `pharmacyemployees` (`EmployeeID`) ON D)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Repository.RepositoryManager.SaveAsync() in E:\GP\Back\Pill-Spot\Repository\RepositoryManager.cs:line 63
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 25
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 21:08:19.292 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 1027.3468ms
2025-03-03 21:08:39.013 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 21:08:39.118 +02:00 [INF] CORS policy execution successful.
2025-03-03 21:08:39.124 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:08:39.140 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 21:08:39.290 +02:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[@p0='?' (DbType = UInt64), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `PharmacyEmployeePermissions` (`EmployeeId`, `PermissionId`)
VALUES (@p0, @p1);
2025-03-03 21:08:39.363 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.RepositoryContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry '1-2' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry '1-2' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-03 21:08:39.523 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 350.9805ms
2025-03-03 21:08:39.657 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:08:39.782 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry '1-2' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Repository.RepositoryManager.SaveAsync() in E:\GP\Back\Pill-Spot\Repository\RepositoryManager.cs:line 63
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 25
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 21:08:39.993 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 980.162ms
2025-03-03 21:16:06.998 +02:00 [INF] Application Started!
2025-03-03 21:16:07.669 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 21:16:08.085 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 21:16:08.091 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 21:16:08.302 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 21:16:08.307 +02:00 [INF] Hosting environment: Development
2025-03-03 21:16:08.309 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 21:16:08.629 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 21:16:09.153 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 526.5849ms
2025-03-03 21:16:09.419 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 21:16:09.420 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 21:16:09.420 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 21:16:09.436 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 17.0409ms
2025-03-03 21:16:09.512 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 92.8292ms
2025-03-03 21:16:09.634 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 214.0179ms
2025-03-03 21:16:09.912 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 21:16:10.207 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 294.3603ms
2025-03-03 21:19:05.043 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/authentication - multipart/form-data; boundary=----WebKitFormBoundaryGL1RJxGNpxsnoyzp 964
2025-03-03 21:19:05.078 +02:00 [INF] CORS policy execution successful.
2025-03-03 21:19:05.179 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation)'
2025-03-03 21:19:05.270 +02:00 [INF] Route matched with {action = "RegisterUser", controller = "Authentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterUser(Shared.DataTransferObjects.UserForRegistrationDto) on controller PillSpot.Presentation.Controllers.AuthenticationController (PillSpot.Presentation).
2025-03-03 21:19:10.673 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.679 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.687 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.692 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.698 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.706 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.711 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.719 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.724 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.729 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.737 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.741 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.750 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:10.755 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:19:11.005 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 21:19:11.011 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 21:19:13.238 +02:00 [INF] Executed DbCommand (149ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 21:19:13.429 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 21:19:14.469 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (Size = 100), @p8='?' (DbType = Int32), @p9='?' (Size = 100), @p10='?' (DbType = Guid), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 256), @p14='?' (Size = 256), @p15='?' (Size = 4000), @p16='?' (Size = 4000), @p17='?' (DbType = Boolean), @p18='?' (Size = 500), @p19='?' (Size = 4000), @p20='?' (DbType = DateTime), @p21='?' (Size = 4000), @p22='?' (DbType = Boolean), @p23='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUsers` (`Id`, `AccessFailedCount`, `ConcurrencyStamp`, `CreatedDate`, `DateOfBirth`, `Email`, `EmailConfirmed`, `FirstName`, `Gender`, `LastName`, `LocationID`, `LockoutEnabled`, `LockoutEnd`, `NormalizedEmail`, `NormalizedUserName`, `PasswordHash`, `PhoneNumber`, `PhoneNumberConfirmed`, `ProfilePictureUrl`, `RefreshToken`, `RefreshTokenExpiryTime`, `SecurityStamp`, `TwoFactorEnabled`, `UserName`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23);
SELECT `IsDeleted`, `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p0;
2025-03-03 21:19:14.681 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 21:19:14.847 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 21:19:14.874 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 21:19:14.932 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 21:19:14.971 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 21:19:15.125 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (Size = 255), @p26='?' (Size = 255), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p27='?' (Size = 4000), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (DbType = Boolean), @p11='?' (Size = 100), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = DateTimeOffset), @p15='?' (Size = 256), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (Size = 500), @p21='?' (Size = 4000), @p22='?' (DbType = DateTime), @p28='?' (DbType = DateTime), @p23='?' (Size = 4000), @p24='?' (DbType = Boolean), @p25='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserRoles` (`RoleId`, `UserId`)
VALUES (@p0, @p1);
UPDATE `AspNetUsers` SET `AccessFailedCount` = @p2, `ConcurrencyStamp` = @p3, `CreatedDate` = @p4, `DateOfBirth` = @p5, `Email` = @p6, `EmailConfirmed` = @p7, `FirstName` = @p8, `Gender` = @p9, `IsDeleted` = @p10, `LastName` = @p11, `LocationID` = @p12, `LockoutEnabled` = @p13, `LockoutEnd` = @p14, `NormalizedEmail` = @p15, `NormalizedUserName` = @p16, `PasswordHash` = @p17, `PhoneNumber` = @p18, `PhoneNumberConfirmed` = @p19, `ProfilePictureUrl` = @p20, `RefreshToken` = @p21, `RefreshTokenExpiryTime` = @p22, `SecurityStamp` = @p23, `TwoFactorEnabled` = @p24, `UserName` = @p25
WHERE `Id` = @p26 AND `ConcurrencyStamp` = @p27 AND `RowVersion` = @p28;
SELECT `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p26;
2025-03-03 21:19:15.173 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 201
2025-03-03 21:19:15.193 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation) in 9903.9692ms
2025-03-03 21:19:15.204 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.AuthenticationController.RegisterUser (PillSpot.Presentation)'
2025-03-03 21:19:15.274 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/authentication - 201 0 null 10230.3248ms
2025-03-03 21:21:41.453 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 21:21:41.551 +02:00 [INF] CORS policy execution successful.
2025-03-03 21:21:41.569 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:21:41.614 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 21:21:42.138 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 21:21:42.165 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 533.8034ms
2025-03-03 21:21:42.171 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:21:42.188 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.UserNotFoundException: User with UserId: 2 was not found
   at Service.EmployeePermissionService.IsEmployeeAsync(Int32 employeeId) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 90
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 26
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 21:21:42.321 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 867.6749ms
2025-03-03 21:41:03.808 +02:00 [INF] Application Started!
2025-03-03 21:41:04.598 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 21:41:05.005 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 21:41:05.010 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 21:41:05.319 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 21:41:05.324 +02:00 [INF] Hosting environment: Development
2025-03-03 21:41:05.327 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 21:41:05.366 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 21:41:05.923 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 558.6413ms
2025-03-03 21:41:06.073 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 21:41:06.118 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 21:41:06.153 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 21:41:06.209 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 90.3335ms
2025-03-03 21:41:06.243 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 169.8155ms
2025-03-03 21:41:06.373 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 219.0754ms
2025-03-03 21:41:06.697 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 21:41:06.923 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 226.098ms
2025-03-03 21:41:24.807 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 21:41:24.938 +02:00 [INF] CORS policy execution successful.
2025-03-03 21:41:25.043 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:41:25.163 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 21:41:30.781 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.787 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.795 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.800 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.809 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.818 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.829 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.835 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.843 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.848 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.854 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.863 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.870 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:30.881 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:41:31.152 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 21:41:31.161 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 21:41:33.579 +02:00 [INF] Executed DbCommand (149ms) [Parameters=[@__employeeId_0='?' (DbType = UInt64)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`UserID`
FROM `PharmacyEmployeePermissions` AS `p`
INNER JOIN (
    SELECT `p0`.`EmployeeID`, `p0`.`UserID`
    FROM `PharmacyEmployees` AS `p0`
    WHERE NOT (`p0`.`IsDeleted`)
) AS `t` ON `p`.`EmployeeId` = `t`.`EmployeeID`
WHERE `p`.`EmployeeId` = @__employeeId_0
LIMIT 1
2025-03-03 21:41:33.675 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 8483.8767ms
2025-03-03 21:41:33.681 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:41:33.693 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.UserNotFoundException: User with userName: 2 was not found
   at Service.EmployeePermissionService.IsEmployeeAsync(UInt64 employeeId) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 92
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 27
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 21:41:33.796 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 8990.2324ms
2025-03-03 21:42:41.001 +02:00 [INF] Application Started!
2025-03-03 21:42:46.792 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 21:42:47.648 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 21:42:47.762 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 21:42:48.187 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 21:42:48.406 +02:00 [INF] Hosting environment: Development
2025-03-03 21:42:48.408 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 21:42:58.637 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/ - null null
2025-03-03 21:42:59.416 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/ - 301 0 null 799.3809ms
2025-03-03 21:43:00.380 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 21:43:01.296 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 916.4086ms
2025-03-03 21:43:01.668 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger-ui.css - null null
2025-03-03 21:43:01.675 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.css - null null
2025-03-03 21:43:01.681 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger-ui-bundle.js - null null
2025-03-03 21:43:01.818 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger-ui-standalone-preset.js - null null
2025-03-03 21:43:01.863 +02:00 [INF] Sending file. Request path: '/index.css'. Physical path: 'N/A'
2025-03-03 21:43:01.877 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.css - 200 202 text/css 202.248ms
2025-03-03 21:43:01.891 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 21:43:01.952 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 61.3222ms
2025-03-03 21:43:02.075 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 21:43:02.479 +02:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-03-03 21:43:02.479 +02:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-03-03 21:43:02.546 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger-ui.css - 200 152034 text/css 878.6689ms
2025-03-03 21:43:02.094 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 21:43:02.551 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger-ui-standalone-preset.js - 200 230293 text/javascript 732.5144ms
2025-03-03 21:43:02.556 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 481.284ms
2025-03-03 21:43:02.901 +02:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-03-03 21:43:02.987 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 893.4035ms
2025-03-03 21:43:02.987 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger-ui-bundle.js - 200 1452753 text/javascript 1304.2974ms
2025-03-03 21:43:04.020 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 21:43:04.426 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 405.6968ms
2025-03-03 21:43:05.820 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/favicon-32x32.png - null null
2025-03-03 21:43:06.574 +02:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-03-03 21:43:06.597 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/favicon-32x32.png - 200 628 image/png 776.4197ms
2025-03-03 21:43:17.393 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 21:43:17.567 +02:00 [INF] CORS policy execution successful.
2025-03-03 21:43:18.111 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:43:18.361 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 21:43:25.878 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:25.889 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:25.901 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:25.909 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:25.929 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:25.986 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:25.995 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:26.009 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:26.020 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:26.027 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:26.039 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:26.046 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:26.176 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:26.253 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:43:26.801 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 21:43:26.823 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 21:43:30.962 +02:00 [INF] Executed DbCommand (381ms) [Parameters=[@__employeeId_0='?' (DbType = UInt64)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`UserID`
FROM `PharmacyEmployeePermissions` AS `p`
INNER JOIN (
    SELECT `p0`.`EmployeeID`, `p0`.`UserID`
    FROM `PharmacyEmployees` AS `p0`
    WHERE NOT (`p0`.`IsDeleted`)
) AS `t` ON `p`.`EmployeeId` = `t`.`EmployeeID`
WHERE `p`.`EmployeeId` = @__employeeId_0
LIMIT 1
2025-03-03 21:49:25.230 +02:00 [INF] Application Started!
2025-03-03 21:49:26.125 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 21:49:26.613 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 21:49:26.617 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 21:49:26.853 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 21:49:27.545 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 21:49:27.567 +02:00 [INF] Hosting environment: Development
2025-03-03 21:49:27.579 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 21:49:28.135 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 582.7148ms
2025-03-03 21:49:28.271 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 21:49:28.271 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 21:49:28.280 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 21:49:28.427 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 158.5935ms
2025-03-03 21:49:28.500 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 229.293ms
2025-03-03 21:49:28.755 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 474.4271ms
2025-03-03 21:49:29.002 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 21:49:29.657 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 652.9421ms
2025-03-03 21:49:46.818 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 21:49:46.921 +02:00 [INF] CORS policy execution successful.
2025-03-03 21:49:47.051 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:49:47.117 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 21:49:50.874 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.880 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.885 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.894 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.898 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.906 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.911 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.915 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.922 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.927 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.931 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.939 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.945 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:50.950 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 21:49:51.194 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 21:49:51.199 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 21:49:53.390 +02:00 [INF] Executed DbCommand (140ms) [Parameters=[@__employeeId_0='?' (DbType = UInt64)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`UserID`
FROM `PharmacyEmployeePermissions` AS `p`
INNER JOIN (
    SELECT `p0`.`EmployeeID`, `p0`.`UserID`
    FROM `PharmacyEmployees` AS `p0`
    WHERE NOT (`p0`.`IsDeleted`)
) AS `t` ON `p`.`EmployeeId` = `t`.`EmployeeID`
WHERE `p`.`EmployeeId` = @__employeeId_0
LIMIT 1
2025-03-03 21:49:53.513 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 6381.8197ms
2025-03-03 21:49:53.520 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 21:49:53.529 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.UserNotFoundException: User with userName: 2 was not found
   at Service.EmployeePermissionService.IsEmployeeAsync(UInt64 employeeId) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 92
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 27
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 21:49:53.646 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 6828.8487ms
2025-03-03 22:12:21.836 +02:00 [INF] Application Started!
2025-03-03 22:12:22.638 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 22:12:23.057 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 22:12:23.064 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 22:12:23.272 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 22:12:23.275 +02:00 [INF] Hosting environment: Development
2025-03-03 22:12:23.277 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 22:12:23.816 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 22:12:24.363 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 544.117ms
2025-03-03 22:12:24.543 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 22:12:24.544 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 22:12:24.551 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 22:12:24.657 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 113.9479ms
2025-03-03 22:12:24.696 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 151.7346ms
2025-03-03 22:12:24.858 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 307.1918ms
2025-03-03 22:12:25.040 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 22:12:25.380 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 340.4639ms
2025-03-03 22:12:44.902 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 22:12:45.020 +02:00 [INF] CORS policy execution successful.
2025-03-03 22:12:45.238 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:12:45.354 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 22:12:50.687 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.698 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.705 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.716 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.722 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.733 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.742 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.750 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.755 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.766 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.772 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.783 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.789 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:50.800 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:12:51.090 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 22:12:51.103 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 22:12:53.731 +02:00 [INF] Executed DbCommand (158ms) [Parameters=[@__employeeId_0='?' (DbType = UInt64)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`UserID`
FROM `PharmacyEmployeePermissions` AS `p`
INNER JOIN (
    SELECT `p0`.`EmployeeID`, `p0`.`UserID`
    FROM `PharmacyEmployees` AS `p0`
    WHERE NOT (`p0`.`IsDeleted`)
) AS `t` ON `p`.`EmployeeId` = `t`.`EmployeeID`
WHERE `p`.`EmployeeId` = @__employeeId_0
LIMIT 1
2025-03-03 22:12:53.834 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 8460.2993ms
2025-03-03 22:12:53.849 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:12:53.862 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.UserNotFoundException: User with userName: 2 was not found
   at Service.EmployeePermissionService.IsEmployeeAsync(UInt64 employeeId) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 92
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 27
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 22:12:54.025 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 9122.817ms
2025-03-03 22:13:13.140 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 22:13:13.317 +02:00 [INF] CORS policy execution successful.
2025-03-03 22:13:13.331 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:13:13.347 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 22:13:13.777 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[@__employeeId_0='?' (DbType = UInt64)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`UserID`
FROM `PharmacyEmployeePermissions` AS `p`
INNER JOIN (
    SELECT `p0`.`EmployeeID`, `p0`.`UserID`
    FROM `PharmacyEmployees` AS `p0`
    WHERE NOT (`p0`.`IsDeleted`)
) AS `t` ON `p`.`EmployeeId` = `t`.`EmployeeID`
WHERE `p`.`EmployeeId` = @__employeeId_0
LIMIT 1
2025-03-03 22:13:14.048 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 22:13:14.609 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 22:13:14.697 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 22:13:14.710 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 1332.8347ms
2025-03-03 22:13:14.714 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:13:14.721 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.NotAnEmployeeException: User with ID '1' is not an pharmacy employee.
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 28
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 22:13:14.761 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 1620.6032ms
2025-03-03 22:16:11.077 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/Admin/assign-user-role - application/json-patch+json 84
2025-03-03 22:16:11.096 +02:00 [INF] CORS policy execution successful.
2025-03-03 22:16:11.108 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.AdminController.AssignUserRole (PillSpot.Presentation)'
2025-03-03 22:16:11.143 +02:00 [INF] Route matched with {action = "AssignUserRole", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignUserRole(Shared.DataTransferObjects.AssignUserRoleDto) on controller PillSpot.Presentation.Controllers.AdminController (PillSpot.Presentation).
2025-03-03 22:16:11.351 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 22:16:11.422 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a0`.`Name`
FROM `AspNetUserRoles` AS `a`
INNER JOIN `AspNetRoles` AS `a0` ON `a`.`RoleId` = `a0`.`Id`
WHERE `a`.`UserId` = @__userId_0
2025-03-03 22:16:11.448 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 22:16:11.469 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 22:16:11.534 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 22:16:11.656 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 22:16:11.844 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 22:16:12.632 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (Size = 255), @p26='?' (Size = 255), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p27='?' (Size = 4000), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (DbType = Boolean), @p11='?' (Size = 100), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = DateTimeOffset), @p15='?' (Size = 256), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (Size = 500), @p21='?' (Size = 4000), @p22='?' (DbType = DateTime), @p28='?' (DbType = DateTime), @p23='?' (Size = 4000), @p24='?' (DbType = Boolean), @p25='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `AspNetUserRoles`
WHERE `RoleId` = @p0 AND `UserId` = @p1;
SELECT ROW_COUNT();

UPDATE `AspNetUsers` SET `AccessFailedCount` = @p2, `ConcurrencyStamp` = @p3, `CreatedDate` = @p4, `DateOfBirth` = @p5, `Email` = @p6, `EmailConfirmed` = @p7, `FirstName` = @p8, `Gender` = @p9, `IsDeleted` = @p10, `LastName` = @p11, `LocationID` = @p12, `LockoutEnabled` = @p13, `LockoutEnd` = @p14, `NormalizedEmail` = @p15, `NormalizedUserName` = @p16, `PasswordHash` = @p17, `PhoneNumber` = @p18, `PhoneNumberConfirmed` = @p19, `ProfilePictureUrl` = @p20, `RefreshToken` = @p21, `RefreshTokenExpiryTime` = @p22, `SecurityStamp` = @p23, `TwoFactorEnabled` = @p24, `UserName` = @p25
WHERE `Id` = @p26 AND `ConcurrencyStamp` = @p27 AND `RowVersion` = @p28;
SELECT `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p26;
2025-03-03 22:16:12.837 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 22:16:12.876 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 22:16:12.922 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 22:16:12.981 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-03-03 22:16:13.098 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-03-03 22:16:13.222 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (Size = 255), @p26='?' (Size = 255), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p27='?' (Size = 4000), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (DbType = Boolean), @p11='?' (Size = 100), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = DateTimeOffset), @p15='?' (Size = 256), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (Size = 500), @p21='?' (Size = 4000), @p22='?' (DbType = DateTime), @p28='?' (DbType = DateTime), @p23='?' (Size = 4000), @p24='?' (DbType = Boolean), @p25='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserRoles` (`RoleId`, `UserId`)
VALUES (@p0, @p1);
UPDATE `AspNetUsers` SET `AccessFailedCount` = @p2, `ConcurrencyStamp` = @p3, `CreatedDate` = @p4, `DateOfBirth` = @p5, `Email` = @p6, `EmailConfirmed` = @p7, `FirstName` = @p8, `Gender` = @p9, `IsDeleted` = @p10, `LastName` = @p11, `LocationID` = @p12, `LockoutEnabled` = @p13, `LockoutEnd` = @p14, `NormalizedEmail` = @p15, `NormalizedUserName` = @p16, `PasswordHash` = @p17, `PhoneNumber` = @p18, `PhoneNumberConfirmed` = @p19, `ProfilePictureUrl` = @p20, `RefreshToken` = @p21, `RefreshTokenExpiryTime` = @p22, `SecurityStamp` = @p23, `TwoFactorEnabled` = @p24, `UserName` = @p25
WHERE `Id` = @p26 AND `ConcurrencyStamp` = @p27 AND `RowVersion` = @p28;
SELECT `RowVersion`
FROM `AspNetUsers`
WHERE ROW_COUNT() = 1 AND `Id` = @p26;
2025-03-03 22:16:13.271 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-03-03 22:16:13.278 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.AdminController.AssignUserRole (PillSpot.Presentation) in 2122.1777ms
2025-03-03 22:16:13.294 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.AdminController.AssignUserRole (PillSpot.Presentation)'
2025-03-03 22:16:13.309 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/Admin/assign-user-role - 204 null null 2231.736ms
2025-03-03 22:16:17.065 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 22:16:17.080 +02:00 [INF] CORS policy execution successful.
2025-03-03 22:16:17.084 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:16:17.226 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 22:16:17.392 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[@__employeeId_0='?' (DbType = UInt64)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`UserID`
FROM `PharmacyEmployeePermissions` AS `p`
INNER JOIN (
    SELECT `p0`.`EmployeeID`, `p0`.`UserID`
    FROM `PharmacyEmployees` AS `p0`
    WHERE NOT (`p0`.`IsDeleted`)
) AS `t` ON `p`.`EmployeeId` = `t`.`EmployeeID`
WHERE `p`.`EmployeeId` = @__employeeId_0
LIMIT 1
2025-03-03 22:16:17.459 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 22:16:17.483 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 22:16:17.502 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 22:16:17.686 +02:00 [ERR] Failed executing DbCommand (10ms) [Parameters=[@p0='?' (DbType = UInt64), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `PharmacyEmployeePermissions` (`EmployeeId`, `PermissionId`)
VALUES (@p0, @p1);
2025-03-03 22:16:17.752 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.RepositoryContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry '1-2' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry '1-2' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-03 22:16:17.827 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 565.8116ms
2025-03-03 22:16:17.834 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:16:17.840 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry '1-2' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Repository.RepositoryManager.SaveAsync() in E:\GP\Back\Pill-Spot\Repository\RepositoryManager.cs:line 63
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 32
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 22:16:18.010 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 944.5618ms
2025-03-03 22:16:28.606 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 22:16:28.612 +02:00 [INF] CORS policy execution successful.
2025-03-03 22:16:28.617 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:16:28.622 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 22:16:28.811 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employeeId_0='?' (DbType = UInt64)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`UserID`
FROM `PharmacyEmployeePermissions` AS `p`
INNER JOIN (
    SELECT `p0`.`EmployeeID`, `p0`.`UserID`
    FROM `PharmacyEmployees` AS `p0`
    WHERE NOT (`p0`.`IsDeleted`)
) AS `t` ON `p`.`EmployeeId` = `t`.`EmployeeID`
WHERE `p`.`EmployeeId` = @__employeeId_0
LIMIT 1
2025-03-03 22:16:28.832 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 22:16:28.864 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 22:16:28.884 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 22:16:28.926 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = UInt64), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `PharmacyEmployeePermissions` (`EmployeeId`, `PermissionId`)
VALUES (@p0, @p1);
2025-03-03 22:16:28.966 +02:00 [INF] Executing CreatedAtRouteResult, writing value of type 'Shared.DataTransferObjects.EmployeePermissionDto'.
2025-03-03 22:16:29.064 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 362.8377ms
2025-03-03 22:16:29.078 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:16:29.088 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 201 null application/json; charset=utf-8 482.4783ms
2025-03-03 22:16:35.709 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 22:16:35.716 +02:00 [INF] CORS policy execution successful.
2025-03-03 22:16:35.721 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:16:35.725 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 22:16:35.844 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__employeeId_0='?' (DbType = UInt64)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`UserID`
FROM `PharmacyEmployeePermissions` AS `p`
INNER JOIN (
    SELECT `p0`.`EmployeeID`, `p0`.`UserID`
    FROM `PharmacyEmployees` AS `p0`
    WHERE NOT (`p0`.`IsDeleted`)
) AS `t` ON `p`.`EmployeeId` = `t`.`EmployeeID`
WHERE `p`.`EmployeeId` = @__employeeId_0
LIMIT 1
2025-03-03 22:16:35.942 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 206.2989ms
2025-03-03 22:16:36.004 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:16:36.050 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.UserNotFoundException: User with userName: 2 was not found
   at Service.EmployeePermissionService.IsEmployeeAsync(UInt64 employeeId) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 92
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 27
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 22:16:36.131 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 422.2677ms
2025-03-03 22:43:40.325 +02:00 [INF] Application Started!
2025-03-03 22:43:40.893 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 22:43:41.376 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 22:43:41.425 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 22:43:41.689 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 22:43:41.864 +02:00 [INF] Hosting environment: Development
2025-03-03 22:43:41.883 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 22:43:42.215 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 22:43:42.720 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 508.8754ms
2025-03-03 22:43:42.933 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 22:43:42.948 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 22:43:42.978 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 22:43:43.041 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 107.6453ms
2025-03-03 22:43:43.093 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 144.9857ms
2025-03-03 22:43:43.375 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 396.6091ms
2025-03-03 22:43:43.551 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 22:43:43.883 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 330.9438ms
2025-03-03 22:44:39.275 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 22:44:39.378 +02:00 [INF] CORS policy execution successful.
2025-03-03 22:44:39.505 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:44:39.606 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 22:44:45.048 +02:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'AdminPermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.066 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.078 +02:00 [WRN] Entity 'Doctor' has a global query filter defined and is the required end of a relationship with the entity 'DoctorPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.083 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'Message'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.090 +02:00 [WRN] Entity 'Order' has a global query filter defined and is the required end of a relationship with the entity 'OrderItem'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.097 +02:00 [WRN] Entity 'PharmacyEmployee' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyEmployeePermission'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.103 +02:00 [WRN] Entity 'Feedback' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyFeedback'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.108 +02:00 [WRN] Entity 'Location' has a global query filter defined and is the required end of a relationship with the entity 'PharmacyRequest'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.115 +02:00 [WRN] Entity 'Ingredient' has a global query filter defined and is the required end of a relationship with the entity 'ProductIngredient'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.121 +02:00 [WRN] Entity 'Batch' has a global query filter defined and is the required end of a relationship with the entity 'ProductPharmacy'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.128 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'ProductPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.135 +02:00 [WRN] Entity 'Chat' has a global query filter defined and is the required end of a relationship with the entity 'UserChat'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.140 +02:00 [WRN] Entity 'Notification' has a global query filter defined and is the required end of a relationship with the entity 'UserNotification'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.148 +02:00 [WRN] Entity 'Prescription' has a global query filter defined and is the required end of a relationship with the entity 'UserPrescription'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-03-03 22:44:45.421 +02:00 [WRN] The foreign key property 'ProductPharmacy.BatchID1' was created in shadow state because a conflicting property with the simple name 'BatchID' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 22:44:45.429 +02:00 [WRN] The foreign key property 'SearchHistory.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-03-03 22:44:47.722 +02:00 [INF] Executed DbCommand (148ms) [Parameters=[@__employeeId_0='?' (DbType = UInt64)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`EmployeeId`, `p`.`PermissionId`, `t`.`EmployeeID`, `t`.`CreatedDate`, `t`.`HireDate`, `t`.`IsDeleted`, `t`.`ModifiedDate`, `t`.`PharmacyID`, `t`.`Role`, `t`.`UserID`, `t0`.`Id`, `t0`.`AccessFailedCount`, `t0`.`ConcurrencyStamp`, `t0`.`CreatedDate`, `t0`.`DateOfBirth`, `t0`.`Email`, `t0`.`EmailConfirmed`, `t0`.`FirstName`, `t0`.`Gender`, `t0`.`IsDeleted`, `t0`.`LastName`, `t0`.`LocationID`, `t0`.`LockoutEnabled`, `t0`.`LockoutEnd`, `t0`.`NormalizedEmail`, `t0`.`NormalizedUserName`, `t0`.`PasswordHash`, `t0`.`PhoneNumber`, `t0`.`PhoneNumberConfirmed`, `t0`.`ProfilePictureUrl`, `t0`.`RefreshToken`, `t0`.`RefreshTokenExpiryTime`, `t0`.`RowVersion`, `t0`.`SecurityStamp`, `t0`.`TwoFactorEnabled`, `t0`.`UserName`
FROM `PharmacyEmployeePermissions` AS `p`
INNER JOIN (
    SELECT `p0`.`EmployeeID`, `p0`.`CreatedDate`, `p0`.`HireDate`, `p0`.`IsDeleted`, `p0`.`ModifiedDate`, `p0`.`PharmacyID`, `p0`.`Role`, `p0`.`UserID`
    FROM `PharmacyEmployees` AS `p0`
    WHERE NOT (`p0`.`IsDeleted`)
) AS `t` ON `p`.`EmployeeId` = `t`.`EmployeeID`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
    FROM `AspNetUsers` AS `a`
    WHERE NOT (`a`.`IsDeleted`)
) AS `t0` ON `t`.`UserID` = `t0`.`Id`
WHERE `p`.`EmployeeId` = @__employeeId_0
LIMIT 1
2025-03-03 22:44:47.820 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 8190.162ms
2025-03-03 22:44:47.828 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:44:47.836 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Entities.Exceptions.UserNotFoundException: User with UserId: 2 was not found
   at Service.EmployeePermissionService.IsEmployeeAsync(UInt64 employeeId) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 92
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 27
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 22:44:47.946 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 8671.1426ms
2025-03-03 22:44:58.308 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - application/json-patch+json 42
2025-03-03 22:44:58.490 +02:00 [INF] CORS policy execution successful.
2025-03-03 22:44:58.496 +02:00 [INF] Executing endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:44:58.510 +02:00 [INF] Route matched with {action = "AssignPermissionToEmployee", controller = "EmployeePermission"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignPermissionToEmployee(Shared.DataTransferObjects.AssignEmployeePermissionDto) on controller PillSpot.Presentation.Controllers.EmployeePermissionController (PillSpot.Presentation).
2025-03-03 22:44:58.990 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[@__employeeId_0='?' (DbType = UInt64)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`EmployeeId`, `p`.`PermissionId`, `t`.`EmployeeID`, `t`.`CreatedDate`, `t`.`HireDate`, `t`.`IsDeleted`, `t`.`ModifiedDate`, `t`.`PharmacyID`, `t`.`Role`, `t`.`UserID`, `t0`.`Id`, `t0`.`AccessFailedCount`, `t0`.`ConcurrencyStamp`, `t0`.`CreatedDate`, `t0`.`DateOfBirth`, `t0`.`Email`, `t0`.`EmailConfirmed`, `t0`.`FirstName`, `t0`.`Gender`, `t0`.`IsDeleted`, `t0`.`LastName`, `t0`.`LocationID`, `t0`.`LockoutEnabled`, `t0`.`LockoutEnd`, `t0`.`NormalizedEmail`, `t0`.`NormalizedUserName`, `t0`.`PasswordHash`, `t0`.`PhoneNumber`, `t0`.`PhoneNumberConfirmed`, `t0`.`ProfilePictureUrl`, `t0`.`RefreshToken`, `t0`.`RefreshTokenExpiryTime`, `t0`.`RowVersion`, `t0`.`SecurityStamp`, `t0`.`TwoFactorEnabled`, `t0`.`UserName`
FROM `PharmacyEmployeePermissions` AS `p`
INNER JOIN (
    SELECT `p0`.`EmployeeID`, `p0`.`CreatedDate`, `p0`.`HireDate`, `p0`.`IsDeleted`, `p0`.`ModifiedDate`, `p0`.`PharmacyID`, `p0`.`Role`, `p0`.`UserID`
    FROM `PharmacyEmployees` AS `p0`
    WHERE NOT (`p0`.`IsDeleted`)
) AS `t` ON `p`.`EmployeeId` = `t`.`EmployeeID`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
    FROM `AspNetUsers` AS `a`
    WHERE NOT (`a`.`IsDeleted`)
) AS `t0` ON `t`.`UserID` = `t0`.`Id`
WHERE `p`.`EmployeeId` = @__employeeId_0
LIMIT 1
2025-03-03 22:44:59.198 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`CreatedDate`, `a`.`DateOfBirth`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`FirstName`, `a`.`Gender`, `a`.`IsDeleted`, `a`.`LastName`, `a`.`LocationID`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`ProfilePictureUrl`, `a`.`RefreshToken`, `a`.`RefreshTokenExpiryTime`, `a`.`RowVersion`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`
FROM `AspNetUsers` AS `a`
WHERE NOT (`a`.`IsDeleted`) AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-03-03 22:44:59.768 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-03-03 22:44:59.850 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-03-03 22:45:00.524 +02:00 [ERR] Failed executing DbCommand (8ms) [Parameters=[@p0='?' (DbType = UInt64), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `PharmacyEmployeePermissions` (`EmployeeId`, `PermissionId`)
VALUES (@p0, @p1);
2025-03-03 22:45:00.708 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Repository.RepositoryContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry '1-2' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry '1-2' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-03 22:45:00.873 +02:00 [INF] Executed action PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation) in 2346.8624ms
2025-03-03 22:45:00.885 +02:00 [INF] Executed endpoint 'PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee (PillSpot.Presentation)'
2025-03-03 22:45:00.893 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry '1-2' for key 'PRIMARY'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Repository.RepositoryManager.SaveAsync() in E:\GP\Back\Pill-Spot\Repository\RepositoryManager.cs:line 63
   at Service.EmployeePermissionService.AssignPermissionToEmployeeAsync(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\Service\EmployeePermissionService.cs:line 32
   at PillSpot.Presentation.Controllers.EmployeePermissionController.AssignPermissionToEmployee(AssignEmployeePermissionDto assignEmployeePermissionDto) in E:\GP\Back\Pill-Spot\PillSpot.Presentation\Controllers\EmployeePermissionController.cs:line 17
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-03-03 22:45:01.165 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7298/api/EmployeePermission/assign - 500 null text/plain; charset=utf-8 2857.0427ms
2025-03-03 22:57:01.697 +02:00 [INF] Application Started!
2025-03-03 22:57:02.721 +02:00 [INF] User profile is available. Using 'C:\Users\Khaled Ibrahem\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-03 22:57:03.208 +02:00 [INF] Now listening on: https://localhost:7298
2025-03-03 22:57:03.225 +02:00 [INF] Now listening on: http://localhost:5146
2025-03-03 22:57:03.477 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-03 22:57:04.647 +02:00 [INF] Hosting environment: Development
2025-03-03 22:57:04.657 +02:00 [INF] Content root path: E:\GP\Back\Pill-Spot\PillSpot
2025-03-03 22:57:05.548 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.html - null null
2025-03-03 22:57:06.501 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.html - 200 null text/html;charset=utf-8 950.7336ms
2025-03-03 22:57:06.690 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - null null
2025-03-03 22:57:06.691 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/index.js - null null
2025-03-03 22:57:06.692 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/_vs/browserLink - null null
2025-03-03 22:57:06.916 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 225.7883ms
2025-03-03 22:57:06.933 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/index.js - 200 null application/javascript;charset=utf-8 242.0726ms
2025-03-03 22:57:07.393 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/_vs/browserLink - 200 null text/javascript; charset=UTF-8 701.3612ms
2025-03-03 22:57:07.910 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - null null
2025-03-03 22:57:08.445 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7298/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 536.2978ms
